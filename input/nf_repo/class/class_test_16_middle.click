/////////////////////////////////////////////////////////////////////////////
// Configuration
define(
	$iface0      em4,
	$macAddr0    ec:f4:bb:d5:fe:d5,
	$ipAddr0     100.0.0.1,
	$ipNetHost0  100.0.0.0/32,
	$ipBcast0    100.0.0.255/32,
	$ipNet0      100.0.0.0/24,
	$color0      1,

	$iface1      eth0,
	$macAddr1    00:60:6e:d5:8a:b8,
	$ipAddr1     200.0.0.1,
	$ipNetHost1  200.0.0.0/32,
	$ipBcast1    200.0.0.255/32,
	$ipNet1      200.0.0.0/24,
	$color1      2,

	$gwIPAddr    200.0.0.2,
	$gwMACAddr   00:00:00:00:00:04,
	$gwPort      2,

	$queueSize   1000000,
	$mtuSize     9000,
	$burst       8
);
/////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////
// Elements
elementclass IPClassifierBench {
	// Module's arguments
	$iface0, $macAddr0,  $ipAddr0, $ipNetHost0, $ipBcast0, $ipNet0, $color0,
	$iface1, $macAddr1,  $ipAddr1, $ipNetHost1, $ipBcast1, $ipNet1, $color1,
	$gwIPAddr, $gwMACAddr, $gwPort, $queueSize, $mtuSize, $burst, $io_method |

	// Queues
	queue :: Queue($queueSize);

	// Module's I/O
	in  :: FromDevice($iface0, BURST $burst);
	out :: ToDevice  ($iface1, BURST $burst);
	
	// ARP Querier
	etherEncap :: EtherEncap(0x0800, $macAddr1, $gwMACAddr);

	// Strip Ethernet header
	strip :: Strip(14);

	// Check IP header's integrity
	markIPHeader :: MarkIPHeader;

	// Measure the incoming pkt rate
	getRate :: AverageCounter;

	/////////////////////////////////////////////////////////////////////
	// Interface's pipeline
	/////////////////////////////////////////////////////////////////////
	// Input
	in -> getRate -> strip;

	// Output
	Idle -> etherEncap -> queue -> out;

	
ipclassifier :: IPClassifier(
	((dst port 16394) || (dst port 23571) || (dst port 50406) || (dst port 50427) || (dst port 61214)) && ((dst net 16.0.0.0/22) || (dst net 16.0.4.0/23) || (dst net 16.0.6.0/24) || (dst net 16.0.7.0/25) || (dst net 16.0.7.128/28) || (dst net 16.0.7.144/30) || (dst net 16.0.7.148/31) || (dst net 16.0.7.151/32) || (dst net 16.0.7.152/29) || (dst net 16.0.7.160/27) || (dst net 16.0.7.192/26) || (dst net 16.0.8.0/21) || (dst net 16.0.16.0/22) || (dst net 16.0.20.0/25) || (dst net 16.0.20.128/28) || (dst net 16.0.20.144/31) || (dst net 16.0.20.147/32) || (dst net 16.0.20.148/30) || (dst net 16.0.20.152/29) || (dst net 16.0.20.160/27) || (dst net 16.0.20.192/26) || (dst net 16.0.21.0/24) || (dst net 16.0.22.0/23) || (dst net 16.0.24.0/22) || (dst net 16.0.28.0/23) || (dst net 16.0.30.0/24) || (dst net 16.0.31.0/25) || (dst net 16.0.31.128/27) || (dst net 16.0.31.160/30) || (dst net 16.0.31.164/31) || (dst net 16.0.31.167/32) || (dst net 16.0.31.168/29) || (dst net 16.0.31.176/28) || (dst net 16.0.31.192/26) || (dst net 16.0.32.0/19) || (dst net 16.0.64.0/19) || (dst net 16.0.96.0/20) || (dst net 16.0.112.0/21) || (dst net 16.0.120.0/22) || (dst net 16.0.124.0/23) || (dst net 16.0.126.0/25) || (dst net 16.0.126.128/30) || (dst net 16.0.126.132/31) || (dst net 16.0.126.134/32) || (dst net 16.0.126.136/29) || (dst net 16.0.126.144/28) || (dst net 16.0.126.160/27) || (dst net 16.0.126.192/26) || (dst net 16.0.127.0/24) || (dst net 16.0.128.0/18) || (dst net 16.0.192.0/19) || (dst net 16.0.224.0/20) || (dst net 16.0.240.0/21) || (dst net 16.0.248.0/24) || (dst net 16.0.249.0/27) || (dst net 16.0.249.32/29) || (dst net 16.0.249.40/30) || (dst net 16.0.249.44/31) || (dst net 16.0.249.46/32) || (dst net 16.0.249.48/28) || (dst net 16.0.249.64/26) || (dst net 16.0.249.128/25) || (dst net 16.0.250.0/23) || (dst net 16.0.252.0/22) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 2383) || (dst port 14527) || (dst port 15111) || (dst port 36871) || (dst port 42771)) && ((dst net 16.0.0.0/18) || (dst net 16.0.64.0/19) || (dst net 16.0.96.0/20) || (dst net 16.0.112.0/21) || (dst net 16.0.120.0/22) || (dst net 16.0.124.0/23) || (dst net 16.0.126.0/24) || (dst net 16.0.127.0/25) || (dst net 16.0.127.128/26) || (dst net 16.0.127.192/27) || (dst net 16.0.127.224/28) || (dst net 16.0.127.240/29) || (dst net 16.0.127.248/30) || (dst net 16.0.127.252/31) || (dst net 16.0.127.255/32) || (dst net 16.0.128.0/19) || (dst net 16.0.160.0/21) || (dst net 16.0.168.0/22) || (dst net 16.0.172.0/31) || (dst net 16.0.172.2/32) || (dst net 16.0.172.4/30) || (dst net 16.0.172.8/29) || (dst net 16.0.172.16/28) || (dst net 16.0.172.32/27) || (dst net 16.0.172.64/26) || (dst net 16.0.172.128/25) || (dst net 16.0.173.0/24) || (dst net 16.0.174.0/25) || (dst net 16.0.174.128/31) || (dst net 16.0.174.130/32) || (dst net 16.0.174.132/30) || (dst net 16.0.174.136/29) || (dst net 16.0.174.144/28) || (dst net 16.0.174.160/27) || (dst net 16.0.174.192/26) || (dst net 16.0.175.0/24) || (dst net 16.0.176.0/21) || (dst net 16.0.184.0/22) || (dst net 16.0.188.0/23) || (dst net 16.0.190.0/24) || (dst net 16.0.191.0/25) || (dst net 16.0.191.128/26) || (dst net 16.0.191.192/28) || (dst net 16.0.191.209/32) || (dst net 16.0.191.210/31) || (dst net 16.0.191.212/30) || (dst net 16.0.191.216/29) || (dst net 16.0.191.224/27) || (dst net 16.0.192.0/24) || (dst net 16.0.193.0/25) || (dst net 16.0.193.128/27) || (dst net 16.0.193.160/28) || (dst net 16.0.193.176/29) || (dst net 16.0.193.184/30) || (dst net 16.0.193.188/32) || (dst net 16.0.193.190/31) || (dst net 16.0.193.192/26) || (dst net 16.0.194.0/23) || (dst net 16.0.196.0/22) || (dst net 16.0.200.0/21) || (dst net 16.0.208.0/20) || (dst net 16.0.224.0/19) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 3122) || (dst port 10470) || (dst port 10874) || (dst port 43385) || (dst port 48767)) && ((dst net 16.0.0.0/19) || (dst net 16.0.32.0/20) || (dst net 16.0.48.0/21) || (dst net 16.0.56.0/24) || (dst net 16.0.57.0/25) || (dst net 16.0.57.128/29) || (dst net 16.0.57.136/30) || (dst net 16.0.57.140/32) || (dst net 16.0.57.142/31) || (dst net 16.0.57.144/28) || (dst net 16.0.57.160/27) || (dst net 16.0.57.192/26) || (dst net 16.0.58.0/24) || (dst net 16.0.59.0/25) || (dst net 16.0.59.128/26) || (dst net 16.0.59.192/28) || (dst net 16.0.59.208/31) || (dst net 16.0.59.210/32) || (dst net 16.0.59.212/30) || (dst net 16.0.59.216/29) || (dst net 16.0.59.224/27) || (dst net 16.0.60.0/22) || (dst net 16.0.64.0/20) || (dst net 16.0.80.0/21) || (dst net 16.0.88.0/22) || (dst net 16.0.92.0/23) || (dst net 16.0.94.0/24) || (dst net 16.0.95.0/28) || (dst net 16.0.95.16/29) || (dst net 16.0.95.24/32) || (dst net 16.0.95.26/31) || (dst net 16.0.95.28/30) || (dst net 16.0.95.32/27) || (dst net 16.0.95.64/26) || (dst net 16.0.95.128/25) || (dst net 16.0.96.0/19) || (dst net 16.0.128.0/20) || (dst net 16.0.144.0/21) || (dst net 16.0.152.0/22) || (dst net 16.0.156.0/24) || (dst net 16.0.157.0/25) || (dst net 16.0.157.128/26) || (dst net 16.0.157.192/28) || (dst net 16.0.157.208/29) || (dst net 16.0.157.216/31) || (dst net 16.0.157.218/32) || (dst net 16.0.157.220/30) || (dst net 16.0.157.224/27) || (dst net 16.0.158.0/23) || (dst net 16.0.160.0/22) || (dst net 16.0.164.0/23) || (dst net 16.0.166.0/24) || (dst net 16.0.167.0/27) || (dst net 16.0.167.32/29) || (dst net 16.0.167.40/30) || (dst net 16.0.167.44/32) || (dst net 16.0.167.46/31) || (dst net 16.0.167.48/28) || (dst net 16.0.167.64/26) || (dst net 16.0.167.128/25) || (dst net 16.0.168.0/21) || (dst net 16.0.176.0/20) || (dst net 16.0.192.0/18) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 1176) || (dst port 3519) || (dst port 32544) || (dst port 38899) || (dst port 47310)) && ((dst net 16.0.0.0/20) || (dst net 16.0.16.0/21) || (dst net 16.0.24.0/22) || (dst net 16.0.28.0/23) || (dst net 16.0.30.0/24) || (dst net 16.0.31.0/25) || (dst net 16.0.31.128/26) || (dst net 16.0.31.192/27) || (dst net 16.0.31.224/28) || (dst net 16.0.31.240/29) || (dst net 16.0.31.248/30) || (dst net 16.0.31.253/32) || (dst net 16.0.31.254/31) || (dst net 16.0.32.0/19) || (dst net 16.0.64.0/19) || (dst net 16.0.96.0/20) || (dst net 16.0.112.0/21) || (dst net 16.0.120.0/23) || (dst net 16.0.122.0/24) || (dst net 16.0.123.0/25) || (dst net 16.0.123.128/26) || (dst net 16.0.123.192/27) || (dst net 16.0.123.224/28) || (dst net 16.0.123.240/30) || (dst net 16.0.123.245/32) || (dst net 16.0.123.246/31) || (dst net 16.0.123.248/29) || (dst net 16.0.124.0/22) || (dst net 16.0.128.0/20) || (dst net 16.0.144.0/21) || (dst net 16.0.152.0/22) || (dst net 16.0.156.0/23) || (dst net 16.0.158.0/25) || (dst net 16.0.158.128/26) || (dst net 16.0.158.192/27) || (dst net 16.0.158.224/28) || (dst net 16.0.158.240/29) || (dst net 16.0.158.248/30) || (dst net 16.0.158.252/31) || (dst net 16.0.158.255/32) || (dst net 16.0.159.0/24) || (dst net 16.0.160.0/19) || (dst net 16.0.192.0/19) || (dst net 16.0.224.0/21) || (dst net 16.0.232.0/24) || (dst net 16.0.233.0/25) || (dst net 16.0.233.128/26) || (dst net 16.0.233.192/27) || (dst net 16.0.233.224/28) || (dst net 16.0.233.240/29) || (dst net 16.0.233.248/30) || (dst net 16.0.233.252/31) || (dst net 16.0.233.254/32) || (dst net 16.0.234.0/23) || (dst net 16.0.236.0/22) || (dst net 16.0.240.0/23) || (dst net 16.0.242.0/25) || (dst net 16.0.242.128/26) || (dst net 16.0.242.192/27) || (dst net 16.0.242.224/28) || (dst net 16.0.242.240/29) || (dst net 16.0.242.248/30) || (dst net 16.0.242.252/32) || (dst net 16.0.242.254/31) || (dst net 16.0.243.0/24) || (dst net 16.0.244.0/22) || (dst net 16.0.248.0/21) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 21565) || (dst port 29225) || (dst port 30654) || (dst port 48712) || (dst port 64042)) && ((dst net 16.0.0.0/20) || (dst net 16.0.16.0/25) || (dst net 16.0.16.128/27) || (dst net 16.0.16.160/28) || (dst net 16.0.16.176/29) || (dst net 16.0.16.184/31) || (dst net 16.0.16.186/32) || (dst net 16.0.16.188/30) || (dst net 16.0.16.192/26) || (dst net 16.0.17.0/24) || (dst net 16.0.18.0/23) || (dst net 16.0.20.0/22) || (dst net 16.0.24.0/21) || (dst net 16.0.32.0/19) || (dst net 16.0.64.0/19) || (dst net 16.0.96.0/20) || (dst net 16.0.112.0/24) || (dst net 16.0.113.0/29) || (dst net 16.0.113.8/30) || (dst net 16.0.113.12/31) || (dst net 16.0.113.14/32) || (dst net 16.0.113.16/28) || (dst net 16.0.113.32/27) || (dst net 16.0.113.64/28) || (dst net 16.0.113.80/29) || (dst net 16.0.113.88/31) || (dst net 16.0.113.90/32) || (dst net 16.0.113.92/30) || (dst net 16.0.113.96/27) || (dst net 16.0.113.128/25) || (dst net 16.0.114.0/23) || (dst net 16.0.116.0/22) || (dst net 16.0.120.0/21) || (dst net 16.0.128.0/22) || (dst net 16.0.132.0/25) || (dst net 16.0.132.128/26) || (dst net 16.0.132.192/27) || (dst net 16.0.132.224/29) || (dst net 16.0.132.232/32) || (dst net 16.0.132.234/31) || (dst net 16.0.132.236/30) || (dst net 16.0.132.240/28) || (dst net 16.0.133.0/24) || (dst net 16.0.134.0/23) || (dst net 16.0.136.0/21) || (dst net 16.0.144.0/20) || (dst net 16.0.160.0/19) || (dst net 16.0.192.0/22) || (dst net 16.0.196.0/24) || (dst net 16.0.197.0/25) || (dst net 16.0.197.128/28) || (dst net 16.0.197.144/29) || (dst net 16.0.197.152/30) || (dst net 16.0.197.156/31) || (dst net 16.0.197.158/32) || (dst net 16.0.197.160/27) || (dst net 16.0.197.192/26) || (dst net 16.0.198.0/23) || (dst net 16.0.200.0/21) || (dst net 16.0.208.0/20) || (dst net 16.0.224.0/19) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 4609) || (dst port 8116) || (dst port 10491) || (dst port 16709) || (dst port 34495)) && ((dst net 16.0.0.0/19) || (dst net 16.0.32.0/21) || (dst net 16.0.40.0/23) || (dst net 16.0.42.0/24) || (dst net 16.0.43.0/25) || (dst net 16.0.43.128/26) || (dst net 16.0.43.192/28) || (dst net 16.0.43.208/29) || (dst net 16.0.43.216/30) || (dst net 16.0.43.220/31) || (dst net 16.0.43.222/32) || (dst net 16.0.43.224/27) || (dst net 16.0.44.0/22) || (dst net 16.0.48.0/22) || (dst net 16.0.52.0/25) || (dst net 16.0.52.128/28) || (dst net 16.0.52.144/32) || (dst net 16.0.52.146/31) || (dst net 16.0.52.148/30) || (dst net 16.0.52.152/29) || (dst net 16.0.52.160/27) || (dst net 16.0.52.192/26) || (dst net 16.0.53.0/24) || (dst net 16.0.54.0/23) || (dst net 16.0.56.0/21) || (dst net 16.0.64.0/20) || (dst net 16.0.80.0/21) || (dst net 16.0.88.0/22) || (dst net 16.0.92.0/23) || (dst net 16.0.94.0/24) || (dst net 16.0.95.0/26) || (dst net 16.0.95.64/28) || (dst net 16.0.95.80/29) || (dst net 16.0.95.88/30) || (dst net 16.0.95.92/31) || (dst net 16.0.95.95/32) || (dst net 16.0.95.96/27) || (dst net 16.0.95.128/25) || (dst net 16.0.96.0/19) || (dst net 16.0.128.0/18) || (dst net 16.0.192.0/19) || (dst net 16.0.224.0/20) || (dst net 16.0.240.0/25) || (dst net 16.0.240.128/28) || (dst net 16.0.240.144/31) || (dst net 16.0.240.146/32) || (dst net 16.0.240.148/30) || (dst net 16.0.240.152/29) || (dst net 16.0.240.160/27) || (dst net 16.0.240.192/26) || (dst net 16.0.241.0/24) || (dst net 16.0.242.0/23) || (dst net 16.0.244.0/23) || (dst net 16.0.246.0/24) || (dst net 16.0.247.0/31) || (dst net 16.0.247.3/32) || (dst net 16.0.247.4/30) || (dst net 16.0.247.8/29) || (dst net 16.0.247.16/28) || (dst net 16.0.247.32/27) || (dst net 16.0.247.64/26) || (dst net 16.0.247.128/25) || (dst net 16.0.248.0/21) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 21445) || (dst port 37800) || (dst port 46764) || (dst port 49693) || (dst port 57141)) && ((dst net 16.0.0.0/20) || (dst net 16.0.16.0/21) || (dst net 16.0.24.0/23) || (dst net 16.0.26.0/25) || (dst net 16.0.26.128/26) || (dst net 16.0.26.192/27) || (dst net 16.0.26.224/29) || (dst net 16.0.26.232/30) || (dst net 16.0.26.236/32) || (dst net 16.0.26.238/31) || (dst net 16.0.26.240/28) || (dst net 16.0.27.0/24) || (dst net 16.0.28.0/22) || (dst net 16.0.32.0/19) || (dst net 16.0.64.0/20) || (dst net 16.0.80.0/21) || (dst net 16.0.88.0/22) || (dst net 16.0.92.0/23) || (dst net 16.0.94.0/26) || (dst net 16.0.94.64/28) || (dst net 16.0.94.80/29) || (dst net 16.0.94.88/31) || (dst net 16.0.94.91/32) || (dst net 16.0.94.92/30) || (dst net 16.0.94.96/27) || (dst net 16.0.94.128/25) || (dst net 16.0.95.0/24) || (dst net 16.0.96.0/21) || (dst net 16.0.104.0/22) || (dst net 16.0.108.0/25) || (dst net 16.0.108.128/30) || (dst net 16.0.108.133/32) || (dst net 16.0.108.134/31) || (dst net 16.0.108.136/29) || (dst net 16.0.108.144/28) || (dst net 16.0.108.160/27) || (dst net 16.0.108.192/26) || (dst net 16.0.109.0/24) || (dst net 16.0.110.0/23) || (dst net 16.0.112.0/20) || (dst net 16.0.128.0/22) || (dst net 16.0.132.0/25) || (dst net 16.0.132.128/29) || (dst net 16.0.132.136/32) || (dst net 16.0.132.138/31) || (dst net 16.0.132.140/30) || (dst net 16.0.132.144/28) || (dst net 16.0.132.160/27) || (dst net 16.0.132.192/26) || (dst net 16.0.133.0/24) || (dst net 16.0.134.0/23) || (dst net 16.0.136.0/21) || (dst net 16.0.144.0/20) || (dst net 16.0.160.0/19) || (dst net 16.0.192.0/20) || (dst net 16.0.208.0/22) || (dst net 16.0.212.0/23) || (dst net 16.0.214.0/24) || (dst net 16.0.215.0/26) || (dst net 16.0.215.64/27) || (dst net 16.0.215.96/28) || (dst net 16.0.215.112/31) || (dst net 16.0.215.114/32) || (dst net 16.0.215.116/30) || (dst net 16.0.215.120/29) || (dst net 16.0.215.128/25) || (dst net 16.0.216.0/21) || (dst net 16.0.224.0/19) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 15757) || (dst port 23730) || (dst port 26326) || (dst port 29824) || (dst port 35358)) && ((dst net 16.0.0.0/18) || (dst net 16.0.64.0/19) || (dst net 16.0.96.0/23) || (dst net 16.0.98.0/24) || (dst net 16.0.99.0/25) || (dst net 16.0.99.128/28) || (dst net 16.0.99.144/29) || (dst net 16.0.99.152/31) || (dst net 16.0.99.155/32) || (dst net 16.0.99.156/30) || (dst net 16.0.99.160/27) || (dst net 16.0.99.192/26) || (dst net 16.0.100.0/22) || (dst net 16.0.104.0/21) || (dst net 16.0.112.0/20) || (dst net 16.0.128.0/20) || (dst net 16.0.144.0/21) || (dst net 16.0.152.0/23) || (dst net 16.0.154.0/24) || (dst net 16.0.155.0/29) || (dst net 16.0.155.8/32) || (dst net 16.0.155.10/31) || (dst net 16.0.155.12/30) || (dst net 16.0.155.16/28) || (dst net 16.0.155.32/27) || (dst net 16.0.155.64/26) || (dst net 16.0.155.128/25) || (dst net 16.0.156.0/22) || (dst net 16.0.160.0/20) || (dst net 16.0.176.0/23) || (dst net 16.0.178.0/24) || (dst net 16.0.179.0/27) || (dst net 16.0.179.32/30) || (dst net 16.0.179.36/31) || (dst net 16.0.179.39/32) || (dst net 16.0.179.40/29) || (dst net 16.0.179.48/28) || (dst net 16.0.179.64/26) || (dst net 16.0.179.128/25) || (dst net 16.0.180.0/22) || (dst net 16.0.184.0/21) || (dst net 16.0.192.0/20) || (dst net 16.0.208.0/22) || (dst net 16.0.212.0/23) || (dst net 16.0.214.0/27) || (dst net 16.0.214.32/29) || (dst net 16.0.214.40/30) || (dst net 16.0.214.45/32) || (dst net 16.0.214.46/31) || (dst net 16.0.214.48/28) || (dst net 16.0.214.64/26) || (dst net 16.0.214.128/25) || (dst net 16.0.215.0/24) || (dst net 16.0.216.0/21) || (dst net 16.0.224.0/21) || (dst net 16.0.232.0/22) || (dst net 16.0.236.0/23) || (dst net 16.0.238.0/24) || (dst net 16.0.239.0/26) || (dst net 16.0.239.64/27) || (dst net 16.0.239.96/29) || (dst net 16.0.239.104/30) || (dst net 16.0.239.108/32) || (dst net 16.0.239.110/31) || (dst net 16.0.239.112/28) || (dst net 16.0.239.128/25) || (dst net 16.0.240.0/20) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((ip proto 17)) && ((dst port 1234)) && ((dst net 200.0.0.2/32)),
	((dst port 14181) || (dst port 34567) || (dst port 43833) || (dst port 52562) || (dst port 56601)) && ((dst net 16.0.0.0/20) || (dst net 16.0.16.0/22) || (dst net 16.0.20.0/24) || (dst net 16.0.21.0/26) || (dst net 16.0.21.64/30) || (dst net 16.0.21.68/32) || (dst net 16.0.21.70/31) || (dst net 16.0.21.72/29) || (dst net 16.0.21.80/28) || (dst net 16.0.21.96/27) || (dst net 16.0.21.128/25) || (dst net 16.0.22.0/23) || (dst net 16.0.24.0/23) || (dst net 16.0.26.0/25) || (dst net 16.0.26.128/26) || (dst net 16.0.26.192/28) || (dst net 16.0.26.208/29) || (dst net 16.0.26.216/30) || (dst net 16.0.26.220/31) || (dst net 16.0.26.222/32) || (dst net 16.0.26.224/27) || (dst net 16.0.27.0/24) || (dst net 16.0.28.0/22) || (dst net 16.0.32.0/19) || (dst net 16.0.64.0/21) || (dst net 16.0.72.0/23) || (dst net 16.0.74.0/27) || (dst net 16.0.74.32/29) || (dst net 16.0.74.40/30) || (dst net 16.0.74.44/31) || (dst net 16.0.74.47/32) || (dst net 16.0.74.48/28) || (dst net 16.0.74.64/26) || (dst net 16.0.74.128/25) || (dst net 16.0.75.0/24) || (dst net 16.0.76.0/22) || (dst net 16.0.80.0/20) || (dst net 16.0.96.0/21) || (dst net 16.0.104.0/23) || (dst net 16.0.106.0/24) || (dst net 16.0.107.0/25) || (dst net 16.0.107.128/26) || (dst net 16.0.107.192/27) || (dst net 16.0.107.224/29) || (dst net 16.0.107.232/30) || (dst net 16.0.107.236/32) || (dst net 16.0.107.238/31) || (dst net 16.0.107.240/28) || (dst net 16.0.108.0/22) || (dst net 16.0.112.0/21) || (dst net 16.0.120.0/25) || (dst net 16.0.120.128/26) || (dst net 16.0.120.192/27) || (dst net 16.0.120.224/29) || (dst net 16.0.120.232/30) || (dst net 16.0.120.236/31) || (dst net 16.0.120.239/32) || (dst net 16.0.120.240/28) || (dst net 16.0.121.0/24) || (dst net 16.0.122.0/23) || (dst net 16.0.124.0/22) || (dst net 16.0.128.0/17) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 211) || (dst port 15261) || (dst port 30131) || (dst port 32201) || (dst port 52125)) && ((dst net 16.0.0.0/20) || (dst net 16.0.16.0/22) || (dst net 16.0.20.0/25) || (dst net 16.0.20.128/27) || (dst net 16.0.20.160/28) || (dst net 16.0.20.176/29) || (dst net 16.0.20.184/30) || (dst net 16.0.20.189/32) || (dst net 16.0.20.190/31) || (dst net 16.0.20.192/26) || (dst net 16.0.21.0/24) || (dst net 16.0.22.0/23) || (dst net 16.0.24.0/21) || (dst net 16.0.32.0/20) || (dst net 16.0.48.0/21) || (dst net 16.0.56.0/22) || (dst net 16.0.60.0/23) || (dst net 16.0.62.0/26) || (dst net 16.0.62.64/27) || (dst net 16.0.62.96/30) || (dst net 16.0.62.100/31) || (dst net 16.0.62.103/32) || (dst net 16.0.62.104/29) || (dst net 16.0.62.112/28) || (dst net 16.0.62.128/25) || (dst net 16.0.63.0/24) || (dst net 16.0.64.0/23) || (dst net 16.0.66.0/24) || (dst net 16.0.67.0/26) || (dst net 16.0.67.64/27) || (dst net 16.0.67.96/28) || (dst net 16.0.67.112/29) || (dst net 16.0.67.120/30) || (dst net 16.0.67.124/31) || (dst net 16.0.67.126/32) || (dst net 16.0.67.128/25) || (dst net 16.0.68.0/22) || (dst net 16.0.72.0/21) || (dst net 16.0.80.0/20) || (dst net 16.0.96.0/23) || (dst net 16.0.98.0/32) || (dst net 16.0.98.2/31) || (dst net 16.0.98.4/30) || (dst net 16.0.98.8/29) || (dst net 16.0.98.16/28) || (dst net 16.0.98.32/27) || (dst net 16.0.98.64/26) || (dst net 16.0.98.128/25) || (dst net 16.0.99.0/24) || (dst net 16.0.100.0/22) || (dst net 16.0.104.0/21) || (dst net 16.0.112.0/20) || (dst net 16.0.128.0/19) || (dst net 16.0.160.0/20) || (dst net 16.0.176.0/22) || (dst net 16.0.180.0/23) || (dst net 16.0.182.0/27) || (dst net 16.0.182.32/29) || (dst net 16.0.182.40/31) || (dst net 16.0.182.43/32) || (dst net 16.0.182.44/30) || (dst net 16.0.182.48/28) || (dst net 16.0.182.64/26) || (dst net 16.0.182.128/25) || (dst net 16.0.183.0/24) || (dst net 16.0.184.0/21) || (dst net 16.0.192.0/18) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 8784) || (dst port 11217) || (dst port 39716) || (dst port 52158) || (dst port 62001)) && ((dst net 16.0.0.0/19) || (dst net 16.0.32.0/21) || (dst net 16.0.40.0/22) || (dst net 16.0.44.0/23) || (dst net 16.0.46.0/24) || (dst net 16.0.47.0/25) || (dst net 16.0.47.128/26) || (dst net 16.0.47.192/28) || (dst net 16.0.47.208/30) || (dst net 16.0.47.213/32) || (dst net 16.0.47.214/31) || (dst net 16.0.47.216/29) || (dst net 16.0.47.224/27) || (dst net 16.0.48.0/20) || (dst net 16.0.64.0/22) || (dst net 16.0.68.0/27) || (dst net 16.0.68.33/32) || (dst net 16.0.68.34/31) || (dst net 16.0.68.36/30) || (dst net 16.0.68.40/29) || (dst net 16.0.68.48/28) || (dst net 16.0.68.64/26) || (dst net 16.0.68.128/25) || (dst net 16.0.69.0/24) || (dst net 16.0.70.0/23) || (dst net 16.0.72.0/21) || (dst net 16.0.80.0/20) || (dst net 16.0.96.0/21) || (dst net 16.0.104.0/22) || (dst net 16.0.108.0/25) || (dst net 16.0.108.128/26) || (dst net 16.0.108.192/28) || (dst net 16.0.108.208/29) || (dst net 16.0.108.216/31) || (dst net 16.0.108.219/32) || (dst net 16.0.108.220/30) || (dst net 16.0.108.224/27) || (dst net 16.0.109.0/24) || (dst net 16.0.110.0/23) || (dst net 16.0.112.0/20) || (dst net 16.0.128.0/19) || (dst net 16.0.160.0/21) || (dst net 16.0.168.0/23) || (dst net 16.0.170.0/27) || (dst net 16.0.170.32/29) || (dst net 16.0.170.40/31) || (dst net 16.0.170.43/32) || (dst net 16.0.170.44/30) || (dst net 16.0.170.48/28) || (dst net 16.0.170.64/26) || (dst net 16.0.170.128/25) || (dst net 16.0.171.0/24) || (dst net 16.0.172.0/22) || (dst net 16.0.176.0/20) || (dst net 16.0.192.0/19) || (dst net 16.0.224.0/20) || (dst net 16.0.240.0/22) || (dst net 16.0.244.0/23) || (dst net 16.0.246.0/25) || (dst net 16.0.246.128/27) || (dst net 16.0.246.160/29) || (dst net 16.0.246.169/32) || (dst net 16.0.246.170/31) || (dst net 16.0.246.172/30) || (dst net 16.0.246.176/28) || (dst net 16.0.246.192/26) || (dst net 16.0.247.0/24) || (dst net 16.0.248.0/21) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 21590) || (dst port 41404) || (dst port 47609) || (dst port 52567) || (dst port 54680)) && ((dst net 16.0.0.0/20) || (dst net 16.0.16.0/26) || (dst net 16.0.16.64/28) || (dst net 16.0.16.80/30) || (dst net 16.0.16.84/32) || (dst net 16.0.16.86/31) || (dst net 16.0.16.88/29) || (dst net 16.0.16.96/27) || (dst net 16.0.16.128/25) || (dst net 16.0.17.0/24) || (dst net 16.0.18.0/23) || (dst net 16.0.20.0/22) || (dst net 16.0.24.0/21) || (dst net 16.0.32.0/19) || (dst net 16.0.64.0/21) || (dst net 16.0.72.0/23) || (dst net 16.0.74.0/25) || (dst net 16.0.74.128/26) || (dst net 16.0.74.192/28) || (dst net 16.0.74.208/29) || (dst net 16.0.74.216/30) || (dst net 16.0.74.220/31) || (dst net 16.0.74.222/32) || (dst net 16.0.74.224/27) || (dst net 16.0.75.0/24) || (dst net 16.0.76.0/22) || (dst net 16.0.80.0/21) || (dst net 16.0.88.0/25) || (dst net 16.0.88.128/26) || (dst net 16.0.88.192/27) || (dst net 16.0.88.224/28) || (dst net 16.0.88.240/30) || (dst net 16.0.88.244/32) || (dst net 16.0.88.246/31) || (dst net 16.0.88.248/29) || (dst net 16.0.89.0/24) || (dst net 16.0.90.0/23) || (dst net 16.0.92.0/22) || (dst net 16.0.96.0/19) || (dst net 16.0.128.0/23) || (dst net 16.0.130.0/26) || (dst net 16.0.130.64/27) || (dst net 16.0.130.96/28) || (dst net 16.0.130.112/29) || (dst net 16.0.130.120/32) || (dst net 16.0.130.122/31) || (dst net 16.0.130.124/30) || (dst net 16.0.130.128/25) || (dst net 16.0.131.0/24) || (dst net 16.0.132.0/22) || (dst net 16.0.136.0/21) || (dst net 16.0.144.0/20) || (dst net 16.0.160.0/19) || (dst net 16.0.192.0/20) || (dst net 16.0.208.0/23) || (dst net 16.0.210.0/24) || (dst net 16.0.211.0/26) || (dst net 16.0.211.64/27) || (dst net 16.0.211.96/29) || (dst net 16.0.211.104/31) || (dst net 16.0.211.106/32) || (dst net 16.0.211.108/30) || (dst net 16.0.211.112/28) || (dst net 16.0.211.128/25) || (dst net 16.0.212.0/22) || (dst net 16.0.216.0/21) || (dst net 16.0.224.0/19) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 5832) || (dst port 13406) || (dst port 14452) || (dst port 34034) || (dst port 60894)) && ((dst net 16.0.0.0/21) || (dst net 16.0.8.0/23) || (dst net 16.0.10.0/25) || (dst net 16.0.10.128/28) || (dst net 16.0.10.144/29) || (dst net 16.0.10.152/31) || (dst net 16.0.10.155/32) || (dst net 16.0.10.156/30) || (dst net 16.0.10.160/27) || (dst net 16.0.10.192/26) || (dst net 16.0.11.0/25) || (dst net 16.0.11.128/28) || (dst net 16.0.11.144/29) || (dst net 16.0.11.152/31) || (dst net 16.0.11.154/32) || (dst net 16.0.11.156/30) || (dst net 16.0.11.160/27) || (dst net 16.0.11.192/26) || (dst net 16.0.12.0/23) || (dst net 16.0.14.0/24) || (dst net 16.0.15.0/25) || (dst net 16.0.15.128/26) || (dst net 16.0.15.192/29) || (dst net 16.0.15.200/30) || (dst net 16.0.15.204/32) || (dst net 16.0.15.206/31) || (dst net 16.0.15.208/28) || (dst net 16.0.15.224/27) || (dst net 16.0.16.0/20) || (dst net 16.0.32.0/22) || (dst net 16.0.36.0/23) || (dst net 16.0.38.0/24) || (dst net 16.0.39.0/27) || (dst net 16.0.39.32/28) || (dst net 16.0.39.48/29) || (dst net 16.0.39.56/30) || (dst net 16.0.39.60/31) || (dst net 16.0.39.62/32) || (dst net 16.0.39.64/26) || (dst net 16.0.39.128/25) || (dst net 16.0.40.0/21) || (dst net 16.0.48.0/20) || (dst net 16.0.64.0/18) || (dst net 16.0.128.0/18) || (dst net 16.0.192.0/22) || (dst net 16.0.196.0/26) || (dst net 16.0.196.64/28) || (dst net 16.0.196.80/29) || (dst net 16.0.196.88/30) || (dst net 16.0.196.92/31) || (dst net 16.0.196.94/32) || (dst net 16.0.196.96/27) || (dst net 16.0.196.128/25) || (dst net 16.0.197.0/24) || (dst net 16.0.198.0/23) || (dst net 16.0.200.0/21) || (dst net 16.0.208.0/20) || (dst net 16.0.224.0/19) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 13149) || (dst port 15244) || (dst port 24797) || (dst port 28580) || (dst port 30769)) && ((dst net 16.0.0.0/18) || (dst net 16.0.64.0/23) || (dst net 16.0.66.0/24) || (dst net 16.0.67.0/30) || (dst net 16.0.67.5/32) || (dst net 16.0.67.6/31) || (dst net 16.0.67.8/29) || (dst net 16.0.67.16/28) || (dst net 16.0.67.32/27) || (dst net 16.0.67.64/26) || (dst net 16.0.67.128/25) || (dst net 16.0.68.0/22) || (dst net 16.0.72.0/21) || (dst net 16.0.80.0/20) || (dst net 16.0.96.0/20) || (dst net 16.0.112.0/21) || (dst net 16.0.120.0/22) || (dst net 16.0.124.0/23) || (dst net 16.0.126.0/25) || (dst net 16.0.126.128/27) || (dst net 16.0.126.160/32) || (dst net 16.0.126.162/31) || (dst net 16.0.126.164/30) || (dst net 16.0.126.168/29) || (dst net 16.0.126.176/28) || (dst net 16.0.126.192/26) || (dst net 16.0.127.0/24) || (dst net 16.0.128.0/19) || (dst net 16.0.160.0/20) || (dst net 16.0.176.0/23) || (dst net 16.0.178.0/24) || (dst net 16.0.179.0/27) || (dst net 16.0.179.33/32) || (dst net 16.0.179.34/31) || (dst net 16.0.179.36/30) || (dst net 16.0.179.40/29) || (dst net 16.0.179.48/28) || (dst net 16.0.179.64/26) || (dst net 16.0.179.128/25) || (dst net 16.0.180.0/25) || (dst net 16.0.180.128/26) || (dst net 16.0.180.192/28) || (dst net 16.0.180.208/29) || (dst net 16.0.180.216/30) || (dst net 16.0.180.221/32) || (dst net 16.0.180.222/31) || (dst net 16.0.180.224/27) || (dst net 16.0.181.0/24) || (dst net 16.0.182.0/27) || (dst net 16.0.182.32/29) || (dst net 16.0.182.40/31) || (dst net 16.0.182.43/32) || (dst net 16.0.182.44/30) || (dst net 16.0.182.48/28) || (dst net 16.0.182.64/26) || (dst net 16.0.182.128/25) || (dst net 16.0.183.0/24) || (dst net 16.0.184.0/21) || (dst net 16.0.192.0/18) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 2073) || (dst port 21599) || (dst port 38771) || (dst port 49361) || (dst port 53930)) && ((dst net 16.0.0.0/21) || (dst net 16.0.8.0/25) || (dst net 16.0.8.128/26) || (dst net 16.0.8.192/30) || (dst net 16.0.8.197/32) || (dst net 16.0.8.198/31) || (dst net 16.0.8.200/29) || (dst net 16.0.8.208/28) || (dst net 16.0.8.224/27) || (dst net 16.0.9.0/24) || (dst net 16.0.10.0/23) || (dst net 16.0.12.0/22) || (dst net 16.0.16.0/20) || (dst net 16.0.32.0/19) || (dst net 16.0.64.0/19) || (dst net 16.0.96.0/20) || (dst net 16.0.112.0/24) || (dst net 16.0.113.0/25) || (dst net 16.0.113.128/26) || (dst net 16.0.113.192/29) || (dst net 16.0.113.200/30) || (dst net 16.0.113.205/32) || (dst net 16.0.113.206/31) || (dst net 16.0.113.208/28) || (dst net 16.0.113.224/27) || (dst net 16.0.114.0/23) || (dst net 16.0.116.0/22) || (dst net 16.0.120.0/21) || (dst net 16.0.128.0/22) || (dst net 16.0.132.0/23) || (dst net 16.0.134.0/28) || (dst net 16.0.134.16/30) || (dst net 16.0.134.20/31) || (dst net 16.0.134.23/32) || (dst net 16.0.134.24/29) || (dst net 16.0.134.32/27) || (dst net 16.0.134.64/26) || (dst net 16.0.134.128/25) || (dst net 16.0.135.0/24) || (dst net 16.0.136.0/21) || (dst net 16.0.144.0/20) || (dst net 16.0.160.0/19) || (dst net 16.0.192.0/20) || (dst net 16.0.208.0/21) || (dst net 16.0.216.0/22) || (dst net 16.0.220.0/26) || (dst net 16.0.220.64/27) || (dst net 16.0.220.96/28) || (dst net 16.0.220.112/29) || (dst net 16.0.220.121/32) || (dst net 16.0.220.122/31) || (dst net 16.0.220.124/30) || (dst net 16.0.220.128/25) || (dst net 16.0.221.0/24) || (dst net 16.0.222.0/23) || (dst net 16.0.224.0/20) || (dst net 16.0.240.0/21) || (dst net 16.0.248.0/23) || (dst net 16.0.250.0/27) || (dst net 16.0.250.32/29) || (dst net 16.0.250.40/30) || (dst net 16.0.250.44/31) || (dst net 16.0.250.47/32) || (dst net 16.0.250.48/28) || (dst net 16.0.250.64/26) || (dst net 16.0.250.128/25) || (dst net 16.0.251.0/24) || (dst net 16.0.252.0/22) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
);

// Performance Testers
setIPClas :: SetCycleCount;
getIPClas0 :: CycleCountAccum;
getIPClas1 :: CycleCountAccum;
getIPClas2 :: CycleCountAccum;
getIPClas3 :: CycleCountAccum;
getIPClas4 :: CycleCountAccum;
getIPClas5 :: CycleCountAccum;
getIPClas6 :: CycleCountAccum;
getIPClas7 :: CycleCountAccum;
getIPClas8 :: CycleCountAccum;
getIPClas9 :: CycleCountAccum;
getIPClas10 :: CycleCountAccum;
getIPClas11 :: CycleCountAccum;
getIPClas12 :: CycleCountAccum;
getIPClas13 :: CycleCountAccum;
getIPClas14 :: CycleCountAccum;
getIPClas15 :: CycleCountAccum;

strip -> markIPHeader -> setIPClas -> [0]ipclassifier;

ipclassifier[0] -> getIPClas0 -> Discard ();
ipclassifier[1] -> getIPClas1 -> Discard ();
ipclassifier[2] -> getIPClas2 -> Discard ();
ipclassifier[3] -> getIPClas3 -> Discard ();
ipclassifier[4] -> getIPClas4 -> Discard ();
ipclassifier[5] -> getIPClas5 -> Discard ();
ipclassifier[6] -> getIPClas6 -> Discard ();
ipclassifier[7] -> getIPClas7 -> Discard ();
ipclassifier[8] -> getIPClas8 -> Discard ();
ipclassifier[9] -> getIPClas9 -> Discard ();
ipclassifier[10] -> getIPClas10 -> Discard ();
ipclassifier[11] -> getIPClas11 -> Discard ();
ipclassifier[12] -> getIPClas12 -> Discard ();
ipclassifier[13] -> getIPClas13 -> Discard ();
ipclassifier[14] -> getIPClas14 -> Discard ();
ipclassifier[15] -> getIPClas15 -> Discard ();
	
}
/////////////////////////////////////////////////////////////////////////////


/////////////////////////////////////////////////////////////////////////////
// Scenario
/////////////////////////////////////////////////////////////////////////////
ipclassifier :: IPClassifierBench(
	$iface0, $macAddr0, $ipAddr0, $ipNetHost0, $ipBcast0, $ipNet0, $color0,
	$iface1, $macAddr1, $ipAddr1, $ipNetHost1, $ipBcast1, $ipNet1, $color1,
	$gwIPAddr, $gwMACAddr, $gwPort, $queueSize, $mtuSize, $burst, $io_method
);
/////////////////////////////////////////////////////////////////////////////
