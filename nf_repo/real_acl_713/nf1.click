define(
		$iface0      netmap:nf1veth0,
		$macAddr0    10:00:00:00:00:01,
		$ipAddr0     10.0.0.1,
		$ipNetHost0  10.0.0.0/32,
		$ipBcast0    10.0.0.255/32,
		$ipNet0      10.0.0.0/24,
		$color0      1,
		
		$iface1      netmap:nf1veth1,
		$macAddr1    10:00:00:00:00:01,
		$ipAddr1     11.0.0.1,
		$ipNetHost1  11.0.0.0/32,
		$ipBcast1    11.0.0.255/32,
		$ipNet1      11.0.0.0/24,
		$color1      2,
		
		$gwIPAddr    11.0.0.2,
		$gwMACAddr   10:00:00:00:00:02,
		$gwPort      2,
		
		$queueSize   2000000,
		$mtuSize     9000,
		$burst       32,
		$io_method   NETMAP,
		
		$position    1,
		
		$lbIPAddr0   11.0.0.2,
		$lbIPAddr1   11.0.0.3
);

/////////////////////////////////////////////////////////////////////////////
// Elements
elementclass Firewall {
	// Module's arguments
	$iface0, $macAddr0,  $ipAddr0, $ipNetHost0, $ipBcast0, $ipNet0, $color0,
	$iface1, $macAddr1,  $ipAddr1, $ipNetHost1, $ipBcast1, $ipNet1, $color1,
	$gwIPAddr, $gwMACAddr, $gwPort, $queueSize, $mtuSize, $burst, $io_method,
	$position |

	// Queues
	queue1 :: Queue($queueSize);

	// Module's I/O
	in0     :: FromDevice($iface0, BURST $burst, SNAPLEN $mtuSize, PROMISC true, METHOD $io_method, SNIFFER false);
	out1    :: ToDevice  ($iface1, BURST $burst, METHOD $io_method);
	
	// EtherEncap because we always send to one gw
	// Interface 0 has a fake destination since we never go back
	etherEncap1 :: EtherEncap(0x0800, $macAddr1, $gwMACAddr);

	// The module that turns this router into L3 firewall
	filter :: IPFilter(
		allow  src net 209.161.198.176/28 && dst net 209.161.198.160/28 && ip proto 17 && src port 88 && dst port 80,
		allow  src net 203.124.178.48/28 && dst net 203.124.183.192/28 && ip proto 17 && src port 123 && dst port 23,
		allow  src net 175.54.90.240/28 && dst net 209.161.199.160/28 && ip proto 17 && src port 53 && dst port 21,
		allow  src net 175.54.96.176/28 && dst net 209.161.199.160/28 && ip proto 17 && src port 123 && dst port 544,
		allow  src net 5.220.189.176/28 && dst net 5.220.186.176/28 && ip proto 17 && src port 750 && dst port 123,
		allow  src net 5.220.188.48/28 && dst net 6.54.125.224/28 && ip proto 17 && src port 67 && dst port 25,
		allow  src net 6.188.134.16/28 && dst net 6.188.129.80/28 && ip proto 17 && src port 162 && dst port 123,
		allow  src net 6.188.134.16/28 && dst net 89.178.111.192/28 && ip proto 17 && src port 750 && dst port 123,
		allow  src net 65.170.11.64/28 && dst net 66.45.212.208/28 && ip proto 17 && src port 53 && dst port 110,
		allow  src net 223.95.160.232/32 && dst net 175.54.102.165/32 && ip proto 17 && src port > 1024 && dst port 80,
		allow  src net 209.161.199.214/32 && dst net 209.161.192.251/32 && ip proto 17 && src port > 1024 && dst port 22,
		allow  src net 209.192.9.126/32 && dst net 211.117.101.86/32 && ip proto 17 && src port > 1024 && dst port 69,
		allow  src net 203.124.179.133/32 && dst net 200.250.134.78/32 && ip proto 17 && src port > 1024 && dst port 22,
		allow  src net 203.124.136.116/32 && dst net 203.124.141.150/32 && ip proto 17 && src port > 1024 && dst port 123,
		allow  src net 175.54.96.171/32 && dst net 175.54.96.186/32 && ip proto 17 && src port > 1024 && dst port 750,
		allow  src net 175.54.96.171/32 && dst net 175.54.102.165/32 && ip proto 17 && src port > 1024 && dst port 161,
		allow  src net 6.188.134.10/32 && dst net 5.220.186.177/32 && ip proto 17 && src port > 1024 && dst port 443,
		allow  src net 6.188.134.10/32 && dst net 6.188.132.172/32 && ip proto 17 && src port > 1024 && dst port 25,
		allow  src net 64.128.44.224/32 && dst net 5.220.186.177/32 && ip proto 17 && src port > 1024 && dst port 179,
		allow  src net 64.128.44.224/32 && dst net 64.128.43.248/32 && ip proto 17 && src port > 1024 && dst port 22,
		allow  src net 65.170.11.72/32 && dst net 66.45.212.138/32 && ip proto 17 && src port > 1024 && dst port 750,
		allow  src net 89.178.104.114/32 && dst net 89.178.107.186/32 && ip proto 17 && src port > 1024 && dst port 22,
		allow  src net 209.192.9.126/32 && dst net 220.223.123.70/32 && ip proto 6 && dst port 161,
		allow  src net 209.192.8.216/32 && dst net 209.192.8.194/32 && ip proto 6 && dst port 69,
		allow  src net 175.54.90.234/32 && dst net 209.161.199.172/32 && ip proto 6 && dst port 544,
		allow  src net 175.54.96.171/32 && dst net 209.161.199.172/32 && ip proto 6 && dst port 110,
		allow  src net 175.54.96.171/32 && dst net 175.54.102.165/32 && ip proto 6 && dst port 67,
		allow  src net 6.188.134.10/32 && dst net 5.220.186.177/32 && ip proto 6 && dst port 119,
		allow  src net 6.188.134.10/32 && dst net 5.220.186.177/32 && ip proto 6 && dst port 1999,
		allow  src net 209.192.8.11/32 && dst net 209.192.15.130/32 && ip proto 17 && src port 88 && dst port > 1024,
		allow  src net 202.97.30.161/32 && dst net 175.54.102.165/32 && ip proto 17 && src port 750 && dst port > 1024,
		allow  src net 175.54.96.171/32 && dst net 164.155.79.197/32 && ip proto 17 && src port 53 && dst port > 1024,
		allow  src net 6.188.134.10/32 && dst net 89.178.111.221/32 && ip proto 17 && src port 123 && dst port > 1024,
		allow  src net 64.128.45.187/32 && dst net 5.220.186.179/32 && ip proto 17 && src port 123 && dst port > 1024,
		allow  src net 89.178.104.114/32 && dst net 85.171.169.107/32 && ip proto 17 && src port 750 && dst port > 1024,
		allow  src net 6.188.134.10/32 && dst net 5.220.186.177/32 && ip proto 17 && dst port 53,
		allow  src net 202.97.31.178/32 && dst net 175.54.102.165/32 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  src net 202.97.30.163/32 && dst net 202.97.27.9/32 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  src net 175.54.90.215/32 && dst net 209.161.199.172/32 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  src net 175.54.96.171/32 && dst net 175.54.96.186/32 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  src net 6.188.134.10/32 && dst net 5.220.186.177/32 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  src net 6.188.134.10/32 && dst net 89.178.111.221/32 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  src net 78.59.69.82/32 && dst net 5.220.186.179/32 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  src net 64.128.44.224/32 && dst net 5.220.186.177/32 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  src net 65.170.11.72/32 && dst net 5.220.186.177/32 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  src net 89.66.135.125/32 && dst net 5.220.186.177/32 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  src net 89.178.104.114/32 && dst net 89.178.111.221/32 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  src net 202.97.31.178/32 && dst net 175.54.102.165/32 && ip proto 17 && src port > 1024 && dst port > 1024,
		allow  src net 203.124.178.50/32 && dst net 200.250.134.151/32 && ip proto 17 && src port > 1024 && dst port > 1024,
		allow  src net 175.54.90.234/32 && dst net 175.54.92.45/32 && ip proto 17 && src port > 1024 && dst port > 1024,
		allow  src net 175.54.96.171/32 && dst net 209.161.199.172/32 && ip proto 17 && src port > 1024 && dst port > 1024,
		allow  src net 175.54.96.171/32 && dst net 164.155.79.147/32 && ip proto 17 && src port > 1024 && dst port > 1024,
		allow  src net 13.2.253.249/32 && dst net 13.2.255.93/32 && ip proto 17 && src port > 1024 && dst port > 1024,
		allow  src net 13.175.50.87/32 && dst net 5.220.186.177/32 && ip proto 17 && src port > 1024 && dst port > 1024,
		allow  src net 65.170.11.66/32 && dst net 5.220.186.177/32 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  src net 89.178.104.114/32 && dst net 87.103.30.144/32 && ip proto 17 && src port > 1024 && dst port > 1024,
		allow  src net 209.192.8.11/32 && ip proto 17 && src port 88 && dst port 80,
		allow  src net 202.97.30.175/32 && ip proto 17 && src port 24032 && dst port 22,
		allow  src net 202.97.30.165/32 && ip proto 17 && src port 123 && dst port 139,
		allow  src net 175.54.96.171/32 && ip proto 17 && src port 53 && dst port 179,
		allow  src net 175.54.96.171/32 && ip proto 17 && src port 88 && dst port 750,
		allow  src net 65.170.11.66/32 && ip proto 17 && src port 53 && dst port 67,
		allow  src net 89.178.104.114/32 && ip proto 17 && src port 53 && dst port 161,
		allow  dst net 5.220.186.179/32 && ip proto 17 && src port 53 && dst port 25,
		allow  dst net 89.178.107.186/32 && ip proto 17 && src port 53 && dst port 80,
		allow  dst net 89.178.107.186/32 && ip proto 17 && src port 7648 && dst port 123,
		allow  dst net 89.178.111.221/32 && ip proto 17 && src port 750 && dst port 25,
		allow  dst net 89.178.111.221/32 && ip proto 17 && src port 69 && dst port 179,
		allow  dst net 175.54.96.136/32 && ip proto 17 && src port 7648 && dst port 67,
		allow  dst net 175.54.102.165/32 && ip proto 17 && src port 161 && dst port 119,
		allow  dst net 175.54.102.165/32 && ip proto 17 && src port 24032 && dst port 25,
		allow  dst net 209.161.192.97/32 && ip proto 17 && src port 123 && dst port 22,
		allow  dst net 209.161.192.97/32 && ip proto 17 && src port 53 && dst port 123,
		allow  dst net 209.161.198.163/32 && ip proto 17 && src port 123 && dst port 5999,
		allow  src net 175.54.90.236/30 && dst net 175.54.90.255/32 && ip proto 6,
		allow  src net 175.54.90.236/30 && dst net 164.155.79.197/32 && ip proto 6,
		allow  src net 175.54.96.172/30 && dst net 209.161.199.172/32 && ip proto 6,
		allow  src net 175.54.96.172/30 && dst net 175.54.102.165/32 && ip proto 6,
		allow  src net 6.188.134.12/30 && dst net 89.178.111.221/32 && ip proto 6,
		allow  src net 78.59.69.84/30 && dst net 5.220.186.179/32 && ip proto 6,
		allow  src net 209.161.199.183/32 && dst net 209.161.199.168/30 && ip proto 6,
		allow  src net 175.54.96.171/32 && dst net 172.232.57.196/30 && ip proto 6,
		allow  src net 175.54.96.171/32 && dst net 172.232.57.184/30 && ip proto 6,
		allow  src net 6.188.134.10/32 && dst net 89.178.111.216/30 && ip proto 6,
		allow  src net 64.128.45.59/32 && dst net 5.220.186.180/30 && ip proto 6,
		allow  src net 89.178.104.114/32 && dst net 5.220.186.180/30 && ip proto 6,
		allow  src net 89.178.104.116/30 && dst net 89.178.107.186/32 && ip proto 6,
		allow  src net 209.161.198.164/32 && dst net 209.161.192.224/28 && ip proto 6,
		allow  src net 175.54.96.171/32 && dst net 175.54.102.160/28 && ip proto 6,
		allow  src net 13.2.221.36/32 && dst net 14.221.74.240/28 && ip proto 6,
		allow  src net 13.175.50.100/32 && dst net 5.220.186.176/28 && ip proto 6,
		allow  src net 6.188.134.10/32 && dst net 6.188.128.112/28 && ip proto 6,
		allow  src net 6.188.134.10/32 && dst net 14.221.74.240/28 && ip proto 6,
		allow  src net 175.54.96.176/28 && dst net 164.155.79.147/32 && ip proto 6,
		allow  src net 5.48.73.128/28 && dst net 89.178.111.221/32 && ip proto 6,
		allow  src net 6.188.134.16/28 && dst net 6.188.134.12/32 && ip proto 6,
		allow  src net 6.188.134.16/28 && dst net 89.178.111.221/32 && ip proto 6,
		allow  src net 6.188.134.16/28 && dst net 14.221.74.243/32 && ip proto 6,
		allow  src net 64.128.45.208/28 && dst net 64.128.43.208/32 && ip proto 6,
		allow  src net 65.170.11.80/28 && dst net 72.174.175.47/32 && ip proto 6,
		allow  src net 209.192.8.230/32 && dst net 220.223.64.0/21 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  src net 202.97.31.178/32 && dst net 202.97.24.0/21 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  src net 202.97.30.175/32 && dst net 201.198.232.0/21 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  src net 202.97.30.161/32 && dst net 201.13.152.0/21 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  src net 175.54.90.198/32 && dst net 209.161.192.0/21 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  src net 175.54.90.234/32 && dst net 209.161.192.0/21 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  src net 175.54.90.234/32 && dst net 175.54.88.0/21 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  src net 175.54.96.171/32 && dst net 175.54.96.0/21 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  src net 175.54.96.171/32 && dst net 173.76.128.0/21 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  src net 6.188.134.10/32 && dst net 14.221.72.0/21 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  src net 6.188.134.10/32 && dst net 5.220.184.0/21 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  src net 78.59.69.18/32 && dst net 5.220.184.0/21 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  src net 65.170.11.72/32 && dst net 5.220.184.0/21 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  src net 89.178.104.114/32 && dst net 84.56.48.0/21 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  src net 221.222.207.238/32 && dst net 221.222.200.0/21 && ip proto 17 && src port > 1024 && dst port > 1024,
		allow  src net 223.95.160.232/32 && dst net 209.161.192.0/21 && ip proto 17 && src port > 1024 && dst port > 1024,
		allow  src net 209.161.250.145/32 && dst net 209.161.248.0/21 && ip proto 17 && src port > 1024 && dst port > 1024,
		allow  src net 209.161.199.244/32 && dst net 175.54.96.0/21 && ip proto 17 && src port > 1024 && dst port > 1024,
		allow  src net 175.54.96.171/32 && dst net 175.54.96.0/21 && ip proto 17 && src port > 1024 && dst port > 1024,
		allow  src net 13.175.50.38/32 && dst net 89.178.104.0/21 && ip proto 17 && src port > 1024 && dst port > 1024,
		drop  src net 209.161.199.176/30 && dst net 209.161.199.172/32,
		drop  src net 6.188.134.10/32 && dst net 6.188.129.96/30,
		allow  dst net 5.220.149.201/32 && ip proto 6 && dst port 443,
		allow  dst net 5.220.149.201/32 && ip proto 6 && dst port 7648,
		allow  dst net 5.220.149.201/32 && ip proto 6 && dst port 22,
		allow  dst net 5.220.149.201/32 && ip proto 6 && dst port 5999,
		allow  dst net 5.220.149.201/32 && ip proto 6 && dst port 544,
		allow  dst net 5.220.149.201/32 && ip proto 6 && dst port 69,
		allow  dst net 5.220.149.200/32 && ip proto 6 && dst port 179,
		allow  dst net 5.220.149.200/32 && ip proto 6 && dst port 2105,
		allow  dst net 5.220.149.200/32 && ip proto 6 && dst port 123,
		allow  dst net 5.220.149.200/32 && ip proto 6 && dst port 21,
		allow  dst net 5.220.149.200/32 && ip proto 6 && dst port 544,
		allow  dst net 5.220.149.200/32 && ip proto 6 && dst port 23,
		allow  dst net 5.220.149.203/32 && ip proto 6 && dst port 22,
		allow  dst net 5.220.149.203/32 && ip proto 6 && dst port 21,
		allow  dst net 5.220.149.203/32 && ip proto 6 && dst port 53,
		allow  dst net 5.220.149.203/32 && ip proto 6 && dst port 161,
		allow  dst net 5.220.149.203/32 && ip proto 6 && dst port 25,
		allow  dst net 5.220.149.203/32 && ip proto 6 && dst port 110,
		allow  dst net 5.220.149.203/32 && ip proto 6 && dst port 119,
		allow  dst net 5.220.149.203/32 && ip proto 6 && dst port 443,
		allow  dst net 5.220.149.203/32 && ip proto 6 && dst port 67,
		allow  dst net 5.220.149.203/32 && ip proto 6 && dst port 37,
		allow  dst net 5.220.149.203/32 && ip proto 6 && dst port 80,
		allow  dst net 5.220.187.37/32 && ip proto 6 && dst port 22,
		allow  dst net 5.220.187.37/32 && ip proto 6 && dst port 53,
		allow  dst net 5.220.187.37/32 && ip proto 6 && dst port 123,
		allow  dst net 5.220.187.37/32 && ip proto 6 && dst port 80,
		allow  dst net 5.220.187.37/32 && ip proto 6 && dst port 443,
		allow  dst net 5.220.187.37/32 && ip proto 6 && dst port 69,
		allow  dst net 5.220.187.37/32 && ip proto 6 && dst port 23,
		allow  dst net 5.220.187.37/32 && ip proto 6 && dst port 8080,
		allow  dst net 5.220.187.37/32 && ip proto 6 && dst port 25,
		allow  dst net 5.220.187.37/32 && ip proto 6 && dst port 88,
		allow  dst net 5.220.186.112/32 && ip proto 6 && dst port 53,
		allow  dst net 5.220.186.116/32 && ip proto 6 && dst port 80,
		allow  dst net 5.220.186.64/32 && ip proto 6 && dst port 750,
		allow  dst net 5.220.186.84/32 && ip proto 6 && dst port 544,
		allow  dst net 5.220.186.34/32 && ip proto 6 && dst port 750,
		allow  dst net 5.220.186.33/32 && ip proto 6 && dst port 88,
		allow  dst net 5.220.186.32/32 && ip proto 6 && dst port 80,
		allow  dst net 5.220.186.19/32 && ip proto 6 && dst port 161,
		allow  dst net 5.220.186.19/32 && ip proto 6 && dst port 750,
		allow  dst net 5.220.186.19/32 && ip proto 6 && dst port 53,
		allow  dst net 5.220.186.19/32 && ip proto 6 && dst port 113,
		allow  dst net 5.220.186.19/32 && ip proto 6 && dst port 22,
		allow  dst net 5.220.186.19/32 && ip proto 6 && dst port 25,
		allow  dst net 5.220.186.224/32 && ip proto 6 && dst port 123,
		allow  dst net 5.220.186.224/32 && ip proto 6 && dst port 754,
		allow  dst net 5.220.186.224/32 && ip proto 6 && dst port 22,
		allow  dst net 5.220.186.229/32 && ip proto 6 && dst port 544,
		allow  dst net 5.220.186.229/32 && ip proto 6 && dst port 24032,
		allow  dst net 5.220.186.229/32 && ip proto 6 && dst port 53,
		allow  dst net 5.220.186.229/32 && ip proto 6 && dst port 37,
		allow  dst net 5.220.186.229/32 && ip proto 6 && dst port 119,
		allow  dst net 5.220.186.144/32 && ip proto 6 && dst port 139,
		allow  dst net 5.220.186.144/32 && ip proto 6 && dst port 137,
		allow  dst net 5.220.186.148/32 && ip proto 6 && dst port 22,
		allow  dst net 5.220.186.179/32 && ip proto 6 && dst port 80,
		allow  dst net 5.220.186.179/32 && ip proto 6 && dst port 22,
		allow  dst net 5.220.186.179/32 && ip proto 6 && dst port 25,
		allow  dst net 91.4.199.17/32 && ip proto 6 && dst port 754,
		allow  dst net 91.4.199.50/32 && ip proto 6 && dst port 123,
		allow  dst net 91.4.199.50/32 && ip proto 6 && dst port 53,
		allow  dst net 89.77.50.11/32 && ip proto 6 && dst port 22,
		allow  dst net 89.178.107.148/32 && ip proto 6 && dst port 22,
		allow  dst net 89.178.107.148/32 && ip proto 6 && dst port 21,
		allow  dst net 89.178.107.148/32 && ip proto 6 && dst port 80,
		allow  dst net 89.178.107.148/32 && ip proto 6 && dst port 23,
		allow  dst net 89.178.107.131/32 && ip proto 6 && dst port 53,
		allow  dst net 89.178.107.133/32 && ip proto 6 && dst port 5999,
		allow  dst net 89.178.107.133/32 && ip proto 6 && dst port 22,
		allow  dst net 89.178.107.134/32 && ip proto 6 && dst port 123,
		allow  dst net 89.178.107.134/32 && ip proto 6 && dst port 53,
		allow  dst net 89.178.107.182/32 && ip proto 6 && dst port 119,
		allow  dst net 89.178.107.182/32 && ip proto 6 && dst port 110,
		allow  dst net 89.178.107.182/32 && ip proto 6 && dst port 23,
		allow  dst net 89.178.107.182/32 && ip proto 6 && dst port 179,
		allow  dst net 89.178.107.180/32 && ip proto 6 && dst port 179,
		allow  dst net 89.178.107.180/32 && ip proto 6 && dst port 110,
		allow  dst net 89.178.107.180/32 && ip proto 6 && dst port 8080,
		allow  dst net 89.178.107.180/32 && ip proto 6 && dst port 22,
		allow  dst net 89.178.107.180/32 && ip proto 6 && dst port 53,
		allow  dst net 89.178.107.186/32 && ip proto 6 && dst port 80,
		allow  dst net 89.178.107.186/32 && ip proto 6 && dst port 53,
		allow  dst net 89.178.107.186/32 && ip proto 6 && dst port 22,
		allow  dst net 89.178.107.186/32 && ip proto 6 && dst port 21,
		allow  dst net 89.178.107.186/32 && ip proto 6 && dst port 123,
		allow  dst net 89.178.107.186/32 && ip proto 6 && dst port 119,
		allow  dst net 89.178.107.186/32 && ip proto 6 && dst port 25,
		allow  dst net 89.178.107.186/32 && ip proto 6 && dst port 750,
		allow  dst net 89.178.111.164/32 && ip proto 6 && dst port 754,
		allow  dst net 89.178.111.164/32 && ip proto 6 && dst port 2105,
		allow  dst net 89.178.111.164/32 && ip proto 6 && dst port 22,
		allow  dst net 89.178.111.164/32 && ip proto 6 && dst port 8080,
		allow  dst net 89.178.111.164/32 && ip proto 6 && dst port 5999,
		allow  dst net 89.178.111.164/32 && ip proto 6 && dst port 179,
		allow  dst net 89.178.111.164/32 && ip proto 6 && dst port 7326,
		allow  dst net 89.178.111.164/32 && ip proto 6 && dst port 25,
		allow  dst net 89.178.111.164/32 && ip proto 6 && dst port 123,
		allow  dst net 89.178.111.164/32 && ip proto 6 && dst port 113,
		allow  dst net 89.178.111.164/32 && ip proto 6 && dst port 443,
		allow  dst net 89.178.111.164/32 && ip proto 6 && dst port 80,
		allow  dst net 89.178.111.164/32 && ip proto 6 && dst port 119,
		allow  dst net 89.178.111.236/32 && ip proto 6 && dst port 7649,
		allow  dst net 89.178.111.236/32 && ip proto 6 && dst port 119,
		allow  dst net 89.178.111.232/32 && ip proto 6 && dst port 2105,
		allow  dst net 89.178.111.232/32 && ip proto 6 && dst port 22,
		allow  dst net 89.178.111.245/32 && ip proto 6 && dst port 443,
		allow  dst net 89.178.111.249/32 && ip proto 6 && dst port 25,
		allow  dst net 89.178.111.249/32 && ip proto 6 && dst port 2105,
		allow  dst net 89.178.111.252/32 && ip proto 6 && dst port 25,
		allow  dst net 89.178.111.252/32 && ip proto 6 && dst port 123,
		allow  dst net 89.178.111.252/32 && ip proto 6 && dst port 80,
		allow  dst net 89.178.111.252/32 && ip proto 6 && dst port 544,
		allow  dst net 89.178.111.252/32 && ip proto 6 && dst port 22,
		allow  dst net 89.178.111.221/32 && ip proto 6 && dst port 873,
		allow  dst net 89.178.111.221/32 && ip proto 6 && dst port 871,
		allow  dst net 89.178.111.221/32 && ip proto 6 && dst port 443,
		allow  dst net 89.178.111.221/32 && ip proto 6 && dst port 22,
		allow  dst net 89.178.111.221/32 && ip proto 6 && dst port 7648,
		allow  dst net 89.178.111.221/32 && ip proto 6 && dst port 80,
		allow  dst net 89.178.111.221/32 && ip proto 6 && dst port 25,
		allow  dst net 89.178.111.221/32 && ip proto 6 && dst port 110,
		allow  dst net 89.178.111.221/32 && ip proto 6 && dst port 754,
		allow  dst net 89.178.111.221/32 && ip proto 6 && dst port 23,
		allow  dst net 89.178.111.221/32 && ip proto 6 && dst port 161,
		allow  dst net 89.178.111.221/32 && ip proto 6 && dst port 53,
		allow  dst net 89.178.111.221/32 && ip proto 6 && dst port 67,
		allow  dst net 89.178.111.221/32 && ip proto 6 && dst port 21,
		allow  dst net 89.178.111.221/32 && ip proto 6 && dst port 143,
		allow  dst net 89.178.111.221/32 && ip proto 6 && dst port 5999,
		allow  dst net 89.178.111.221/32 && ip proto 6 && dst port 37,
		allow  dst net 89.178.111.221/32 && ip proto 6 && dst port 119,
		allow  dst net 89.178.111.221/32 && ip proto 6 && dst port 138,
		allow  dst net 175.54.91.220/32 && ip proto 6 && dst port 53,
		allow  dst net 175.54.91.220/32 && ip proto 6 && dst port 22,
		allow  dst net 175.54.91.222/32 && ip proto 6 && dst port 88,
		allow  dst net 175.54.91.222/32 && ip proto 6 && dst port 138,
		allow  dst net 175.54.90.248/32 && ip proto 6 && dst port 22,
		allow  dst net 175.54.90.255/32 && ip proto 6 && dst port 25,
		allow  dst net 175.54.90.54/32 && ip proto 6 && dst port 750,
		allow  dst net 175.54.90.62/32 && ip proto 6 && dst port 750,
		allow  dst net 175.54.90.62/32 && ip proto 6 && dst port 22,
		allow  dst net 175.54.93.146/32 && ip proto 6 && dst port 179,
		allow  dst net 175.54.93.146/32 && ip proto 6 && dst port 161,
		allow  dst net 175.54.93.146/32 && ip proto 6 && dst port 750,
		allow  dst net 175.54.93.146/32 && ip proto 6 && dst port 22,
		allow  dst net 175.54.93.146/32 && ip proto 6 && dst port 25,
		allow  dst net 175.54.92.164/32 && ip proto 6 && dst port 8080,
		allow  dst net 175.54.92.164/32 && ip proto 6 && dst port 21,
		allow  dst net 175.54.92.164/32 && ip proto 6 && dst port 143,
		allow  dst net 175.54.92.164/32 && ip proto 6 && dst port 13,
		allow  dst net 175.54.92.46/32 && ip proto 6 && dst port 53,
		allow  dst net 175.54.92.46/32 && ip proto 6 && dst port 22,
		allow  dst net 175.54.92.46/32 && ip proto 6 && dst port 750,
		allow  dst net 175.54.92.46/32 && ip proto 6 && dst port 25,
		allow  dst net 175.54.92.46/32 && ip proto 6 && dst port 21,
		allow  dst net 175.54.92.44/32 && ip proto 6 && dst port 123,
		allow  dst net 175.54.92.44/32 && ip proto 6 && dst port 24032,
		allow  dst net 175.54.92.45/32 && ip proto 6 && dst port 443,
		allow  dst net 175.54.96.139/32 && ip proto 6 && dst port 80,
		allow  dst net 175.54.96.139/32 && ip proto 6 && dst port 53,
		allow  dst net 175.54.96.136/32 && ip proto 6 && dst port 110,
		allow  dst net 175.54.96.185/32 && ip proto 6 && dst port 25,
		allow  dst net 175.54.96.185/32 && ip proto 6 && dst port 123,
		allow  dst net 175.54.96.185/32 && ip proto 6 && dst port 88,
		allow  dst net 175.54.96.185/32 && ip proto 6 && dst port 544,
		allow  dst net 175.54.96.186/32 && ip proto 6 && dst port 25,
		allow  dst net 175.54.96.186/32 && ip proto 6 && dst port 22,
		allow  dst net 175.54.96.186/32 && ip proto 6 && dst port 23,
		allow  dst net 175.54.96.186/32 && ip proto 6 && dst port 2055,
		allow  dst net 175.54.96.186/32 && ip proto 6 && dst port 123,
		allow  dst net 175.54.96.186/32 && ip proto 6 && dst port 2105,
		allow  dst net 175.54.96.186/32 && ip proto 6 && dst port 750,
		allow  dst net 175.54.96.186/32 && ip proto 6 && dst port 5999,
		allow  dst net 175.54.96.186/32 && ip proto 6 && dst port 80,
		allow  dst net 175.54.102.169/32 && ip proto 6 && dst port 53,
		allow  dst net 175.54.102.169/32 && ip proto 6 && dst port 25,
		allow  dst net 175.54.102.169/32 && ip proto 6 && dst port 22,
		allow  dst net 175.54.102.169/32 && ip proto 6 && dst port 80,
		allow  dst net 175.54.102.173/32 && ip proto 6 && dst port 22,
		allow  dst net 175.54.102.172/32 && ip proto 6 && dst port 67,
		allow  dst net 175.54.102.174/32 && ip proto 6 && dst port 8080,
		allow  dst net 175.54.102.175/32 && ip proto 6 && dst port 123,
		allow  dst net 175.54.102.165/32 && ip proto 6 && dst port 22,
		allow  dst net 175.54.102.165/32 && ip proto 6 && dst port 7648,
		allow  dst net 175.54.102.165/32 && ip proto 6 && dst port 754,
		allow  dst net 175.54.102.165/32 && ip proto 6 && dst port 25,
		allow  dst net 175.54.102.165/32 && ip proto 6 && dst port 879,
		allow  dst net 175.54.102.165/32 && ip proto 6 && dst port 161,
		allow  dst net 175.54.102.165/32 && ip proto 6 && dst port 80,
		allow  dst net 175.54.102.165/32 && ip proto 6 && dst port 119,
		allow  dst net 175.54.102.165/32 && ip proto 6 && dst port 24032,
		allow  dst net 175.54.102.165/32 && ip proto 6 && dst port 69,
		allow  dst net 175.54.102.165/32 && ip proto 6 && dst port 53,
		allow  dst net 175.54.102.165/32 && ip proto 6 && dst port 1999,
		allow  dst net 175.54.102.165/32 && ip proto 6 && dst port 873,
		allow  dst net 210.57.53.60/32 && ip proto 6 && dst port 80,
		allow  dst net 210.57.54.138/32 && ip proto 6 && dst port 25,
		allow  dst net 211.117.101.124/32 && ip proto 6 && dst port 22,
		allow  dst net 209.161.248.143/32 && ip proto 6 && dst port 22,
		allow  dst net 209.161.248.143/32 && ip proto 6 && dst port 123,
		allow  dst net 209.161.248.143/32 && ip proto 6 && dst port 2105,
		allow  dst net 209.161.248.143/32 && ip proto 6 && dst port 544,
		allow  dst net 209.161.248.143/32 && ip proto 6 && dst port 69,
		allow  dst net 209.161.248.139/32 && ip proto 6 && dst port 22,
		allow  dst net 209.161.248.139/32 && ip proto 6 && dst port 88,
		allow  dst net 209.161.248.139/32 && ip proto 6 && dst port 25,
		allow  dst net 209.161.248.139/32 && ip proto 6 && dst port 80,
		allow  dst net 209.161.248.137/32 && ip proto 6 && dst port 22,
		allow  dst net 209.161.248.137/32 && ip proto 6 && dst port 53,
		allow  dst net 209.161.248.136/32 && ip proto 6 && dst port 22,
		allow  dst net 209.161.248.136/32 && ip proto 6 && dst port 37,
		allow  dst net 209.161.248.136/32 && ip proto 6 && dst port 23,
		allow  dst net 209.161.248.39/32 && ip proto 6 && dst port 22,
		allow  dst net 209.161.248.39/32 && ip proto 6 && dst port 113,
		allow  dst net 209.161.248.39/32 && ip proto 6 && dst port 53,
		allow  dst net 209.161.248.39/32 && ip proto 6 && dst port 123,
		allow  dst net 209.161.248.60/32 && ip proto 6 && dst port 544,
		allow  dst net 209.161.248.60/32 && ip proto 6 && dst port 22,
		allow  dst net 209.161.248.60/32 && ip proto 6 && dst port 53,
		allow  dst net 209.161.248.60/32 && ip proto 6 && dst port 143,
		allow  dst net 209.161.248.60/32 && ip proto 6 && dst port 2105,
		allow  dst net 209.161.248.60/32 && ip proto 6 && dst port 119,
		allow  dst net 209.161.248.59/32 && ip proto 6 && dst port 24032,
		allow  dst net 209.161.248.59/32 && ip proto 6 && dst port 161,
		allow  dst net 209.161.248.59/32 && ip proto 6 && dst port 53,
		allow  dst net 209.161.248.56/32 && ip proto 6 && dst port 123,
		allow  dst net 209.161.248.56/32 && ip proto 6 && dst port 25,
		allow  dst net 209.161.248.56/32 && ip proto 6 && dst port 80,
		allow  dst net 209.161.248.56/32 && ip proto 6 && dst port 161,
		allow  dst net 209.161.192.8/32 && ip proto 6 && dst port 25,
		allow  dst net 209.161.192.8/32 && ip proto 6 && dst port 53,
		allow  dst net 209.161.192.9/32 && ip proto 6 && dst port 25,
		allow  dst net 209.161.192.9/32 && ip proto 6 && dst port 80,
		allow  dst net 209.161.192.73/32 && ip proto 6 && dst port 25,
		allow  dst net 209.161.192.72/32 && ip proto 6 && dst port 21,
		allow  dst net 209.161.192.97/32 && ip proto 6 && dst port 138,
		allow  dst net 209.161.192.97/32 && ip proto 6 && dst port 53,
		allow  dst net 209.161.192.97/32 && ip proto 6 && dst port 22,
		allow  dst net 209.161.192.246/32 && ip proto 6 && dst port 119,
		allow  dst net 209.161.192.246/32 && ip proto 6 && dst port 2055,
		allow  dst net 209.161.192.246/32 && ip proto 6 && dst port 25,
		allow  dst net 209.161.192.246/32 && ip proto 6 && dst port 123,
		allow  dst net 209.161.192.246/32 && ip proto 6 && dst port 179,
		allow  dst net 209.161.192.251/32 && ip proto 6 && dst port 25,
		allow  dst net 209.161.192.251/32 && ip proto 6 && dst port 22,
		allow  dst net 209.161.192.251/32 && ip proto 6 && dst port 7648,
		allow  dst net 209.161.192.251/32 && ip proto 6 && dst port 23,
		allow  dst net 209.161.192.251/32 && ip proto 6 && dst port 139,
		allow  dst net 209.161.192.251/32 && ip proto 6 && dst port 80,
		allow  dst net 209.161.198.73/32 && ip proto 6 && dst port 750,
		allow  dst net 209.161.198.74/32 && ip proto 6 && dst port 754,
		allow  dst net 209.161.198.74/32 && ip proto 6 && dst port 53,
		allow  dst net 209.161.198.77/32 && ip proto 6 && dst port 53,
		allow  dst net 209.161.198.77/32 && ip proto 6 && dst port 22,
		allow  dst net 209.161.198.78/32 && ip proto 6 && dst port 2105,
		allow  dst net 209.161.198.181/32 && ip proto 6 && dst port 25,
		allow  dst net 209.161.198.181/32 && ip proto 6 && dst port 544,
		allow  dst net 209.161.198.160/32 && ip proto 6 && dst port 22,
		allow  dst net 209.161.198.160/32 && ip proto 6 && dst port 544,
		allow  dst net 209.161.198.167/32 && ip proto 6 && dst port 119,
		allow  dst net 209.161.198.164/32 && ip proto 6 && dst port 750,
		allow  dst net 209.161.198.164/32 && ip proto 6 && dst port 22,
		allow  dst net 209.161.199.245/32 && ip proto 6 && dst port 24032,
		allow  dst net 209.161.199.240/32 && ip proto 6 && dst port 25,
		allow  dst net 209.161.199.202/32 && ip proto 6 && dst port 138,
		allow  dst net 209.161.199.203/32 && ip proto 6 && dst port 24032,
		allow  dst net 209.161.199.200/32 && ip proto 6 && dst port 123,
		allow  dst net 209.161.199.222/32 && ip proto 6 && dst port 544,
		allow  dst net 209.161.199.222/32 && ip proto 6 && dst port 22,
		allow  dst net 209.161.199.223/32 && ip proto 6 && dst port 53,
		allow  dst net 209.161.199.221/32 && ip proto 6 && dst port 69,
		allow  dst net 209.161.199.146/32 && ip proto 6 && dst port 25,
		allow  dst net 209.161.199.144/32 && ip proto 6 && dst port 80,
		allow  dst net 209.161.199.150/32 && ip proto 6 && dst port 67,
		allow  dst net 209.161.199.150/32 && ip proto 6 && dst port 1999,
		allow  dst net 209.161.199.148/32 && ip proto 6 && dst port 750,
		allow  dst net 209.161.199.148/32 && ip proto 6 && dst port 80,
		allow  dst net 209.161.199.148/32 && ip proto 6 && dst port 1999,
		allow  dst net 209.161.199.161/32 && ip proto 6 && dst port 123,
		allow  dst net 209.161.199.161/32 && ip proto 6 && dst port 25,
		allow  dst net 209.161.199.161/32 && ip proto 6 && dst port 24032,
		allow  dst net 209.161.199.165/32 && ip proto 6 && dst port 67,
		allow  dst net 209.161.199.165/32 && ip proto 6 && dst port 53,
		allow  dst net 209.161.199.165/32 && ip proto 6 && dst port 123,
		allow  dst net 209.161.199.172/32 && ip proto 6 && dst port 25,
		allow  dst net 209.161.199.172/32 && ip proto 6 && dst port 53,
		allow  dst net 209.161.199.172/32 && ip proto 6 && dst port 443,
		allow  src net 209.161.196.177/32 && ip proto 17 && src port 67 && dst port > 1024,
		allow  src net 203.124.179.135/32 && ip proto 17 && src port 88 && dst port > 1024,
		allow  src net 175.54.90.234/32 && ip proto 17 && src port 750 && dst port > 1024,
		allow  src net 175.54.96.171/32 && ip proto 17 && src port 7648 && dst port > 1024,
		allow  src net 175.54.96.171/32 && ip proto 17 && src port 750 && dst port > 1024,
		allow  src net 175.54.96.171/32 && ip proto 17 && src port 53 && dst port > 1024,
		allow  src net 64.128.44.224/32 && ip proto 17 && src port 123 && dst port > 1024,
		allow  src net 89.178.104.114/32 && ip proto 17 && src port 123 && dst port > 1024,
		allow  src net 89.178.104.114/32 && ip proto 17 && src port 53 && dst port > 1024,
		allow  dst net 5.220.149.203/32 && ip proto 17 && src port > 1024 && dst port 22,
		allow  dst net 89.178.107.131/32 && ip proto 17 && src port > 1024 && dst port 22,
		allow  dst net 89.178.111.221/32 && ip proto 17 && src port > 1024 && dst port 25,
		allow  dst net 175.54.102.175/32 && ip proto 17 && src port > 1024 && dst port 22,
		allow  dst net 175.54.102.175/32 && ip proto 17 && src port > 1024 && dst port 13,
		allow  dst net 209.161.248.59/32 && ip proto 17 && src port > 1024 && dst port 2055,
		allow  src net 209.192.8.11/32 && ip proto 6 && dst port 53,
		allow  src net 203.124.136.116/32 && ip proto 6 && dst port 53,
		allow  src net 203.124.136.116/32 && ip proto 6 && dst port 37,
		allow  src net 175.54.96.171/32 && ip proto 6 && dst port 143,
		allow  src net 6.188.134.10/32 && ip proto 6 && dst port 161,
		allow  src net 6.188.134.10/32 && ip proto 6 && dst port 37,
		allow  src net 6.188.134.10/32 && ip proto 6 && dst port 750,
		allow  src net 6.188.134.10/32 && ip proto 6 && dst port 22,
		allow  src net 64.128.44.224/32 && ip proto 6 && dst port 80,
		allow  src net 65.170.11.95/32 && ip proto 6 && dst port 871,
		allow  src net 89.178.104.114/32 && ip proto 6 && dst port 873,
		allow  dst net 5.220.149.201/32 && ip proto 17 && dst port 80,
		allow  dst net 5.220.149.201/32 && ip proto 17 && dst port 25,
		allow  dst net 5.220.149.200/32 && ip proto 17 && dst port 750,
		allow  dst net 5.220.149.200/32 && ip proto 17 && dst port 25,
		allow  dst net 5.220.149.200/32 && ip proto 17 && dst port 22,
		allow  dst net 5.220.149.203/32 && ip proto 17 && dst port 67,
		allow  dst net 5.220.149.203/32 && ip proto 17 && dst port 179,
		allow  dst net 5.220.149.203/32 && ip proto 17 && dst port 53,
		allow  dst net 5.220.149.203/32 && ip proto 17 && dst port 88,
		allow  dst net 5.220.187.37/32 && ip proto 17 && dst port 80,
		allow  dst net 5.220.187.37/32 && ip proto 17 && dst port 25,
		allow  dst net 5.220.187.37/32 && ip proto 17 && dst port 22,
		allow  dst net 5.220.187.37/32 && ip proto 17 && dst port 544,
		allow  dst net 5.220.186.67/32 && ip proto 17 && dst port 22,
		allow  dst net 5.220.186.93/32 && ip proto 17 && dst port 113,
		allow  dst net 5.220.186.84/32 && ip proto 17 && dst port 750,
		allow  dst net 5.220.186.19/32 && ip proto 17 && dst port 80,
		allow  dst net 5.220.186.19/32 && ip proto 17 && dst port 871,
		allow  dst net 5.220.186.19/32 && ip proto 17 && dst port 22,
		allow  dst net 5.220.186.229/32 && ip proto 17 && dst port 67,
		allow  dst net 5.220.186.144/32 && ip proto 17 && dst port 80,
		allow  dst net 5.220.186.150/32 && ip proto 17 && dst port 22,
		allow  dst net 91.4.199.50/32 && ip proto 17 && dst port 22,
		allow  dst net 89.178.107.131/32 && ip proto 17 && dst port 53,
		allow  dst net 89.178.107.133/32 && ip proto 17 && dst port 53,
		allow  dst net 89.178.107.182/32 && ip proto 17 && dst port 80,
		allow  dst net 89.178.107.182/32 && ip proto 17 && dst port 25,
		allow  dst net 89.178.107.180/32 && ip proto 17 && dst port 179,
		allow  dst net 89.178.107.180/32 && ip proto 17 && dst port 544,
		allow  dst net 89.178.107.186/32 && ip proto 17 && dst port 8080,
		allow  dst net 89.178.107.186/32 && ip proto 17 && dst port 879,
		allow  dst net 89.178.107.186/32 && ip proto 17 && dst port 21,
		allow  dst net 89.178.107.186/32 && ip proto 17 && dst port 37,
		allow  dst net 89.178.107.186/32 && ip proto 17 && dst port 119,
		allow  dst net 89.178.111.164/32 && ip proto 17 && dst port 161,
		allow  dst net 89.178.111.164/32 && ip proto 17 && dst port 25,
		allow  dst net 89.178.111.164/32 && ip proto 17 && dst port 179,
		allow  dst net 89.178.111.164/32 && ip proto 17 && dst port 5999,
		allow  dst net 89.178.111.164/32 && ip proto 17 && dst port 2105,
		allow  dst net 89.178.111.164/32 && ip proto 17 && dst port 80,
		allow  dst net 89.178.111.235/32 && ip proto 17 && dst port 23,
		allow  dst net 89.178.111.245/32 && ip proto 17 && dst port 21,
		allow  dst net 89.178.111.245/32 && ip proto 17 && dst port 123,
		allow  dst net 89.178.111.249/32 && ip proto 17 && dst port 1999,
		allow  dst net 89.178.111.221/32 && ip proto 17 && dst port 25,
		allow  dst net 89.178.111.221/32 && ip proto 17 && dst port 22,
		allow  dst net 89.178.111.221/32 && ip proto 17 && dst port 80,
		allow  dst net 89.178.111.221/32 && ip proto 17 && dst port 123,
		allow  dst net 89.178.111.221/32 && ip proto 6 && dst port 8080,
		allow  dst net 89.178.111.221/32 && ip proto 17 && dst port 53,
		allow  dst net 175.54.91.222/32 && ip proto 17 && dst port 22,
		allow  dst net 175.54.90.55/32 && ip proto 17 && dst port 80,
		allow  dst net 175.54.90.62/32 && ip proto 17 && dst port 80,
		allow  dst net 175.54.90.62/32 && ip proto 17 && dst port 2105,
		allow  dst net 175.54.93.146/32 && ip proto 6 && dst port 53,
		allow  dst net 175.54.93.146/32 && ip proto 17 && dst port 123,
		allow  dst net 175.54.92.164/32 && ip proto 17 && dst port 544,
		allow  dst net 175.54.92.164/32 && ip proto 17 && dst port 22,
		allow  dst net 175.54.92.164/32 && ip proto 17 && dst port 443,
		allow  dst net 175.54.92.44/32 && ip proto 17 && dst port 22,
		allow  dst net 175.54.92.44/32 && ip proto 17 && dst port 53,
		allow  dst net 175.54.96.139/32 && ip proto 6 && dst port 22,
		allow  dst net 175.54.96.136/32 && ip proto 6 && dst port 754,
		allow  dst net 175.54.96.136/32 && ip proto 17 && dst port 53,
		allow  dst net 175.54.96.185/32 && ip proto 17 && dst port 25,
		allow  dst net 175.54.96.185/32 && ip proto 17 && dst port 37,
		allow  dst net 175.54.96.185/32 && ip proto 17 && dst port 22,
		allow  dst net 175.54.96.185/32 && ip proto 17 && dst port 21,
		allow  dst net 175.54.96.185/32 && ip proto 17 && dst port 113,
		allow  dst net 175.54.96.185/32 && ip proto 17 && dst port 53,
		allow  dst net 175.54.96.186/32 && ip proto 17 && dst port 1999,
		allow  dst net 175.54.96.186/32 && ip proto 17 && dst port 22,
		allow  dst net 175.54.102.173/32 && ip proto 17 && dst port 119,
		allow  dst net 175.54.102.174/32 && ip proto 17 && dst port 88,
		allow  dst net 175.54.102.165/32 && ip proto 17 && dst port 80,
		allow  dst net 175.54.102.165/32 && ip proto 17 && dst port 25,
		allow  dst net 175.54.102.165/32 && ip proto 17 && dst port 22,
		allow  dst net 175.54.102.165/32 && ip proto 17 && dst port 21,
		allow  dst net 175.54.102.165/32 && ip proto 17 && dst port 37,
		allow  dst net 209.161.248.143/32 && ip proto 17 && dst port 24032,
		allow  dst net 209.161.248.139/32 && ip proto 17 && dst port 21,
		allow  dst net 209.161.248.39/32 && ip proto 17 && dst port 123,
		allow  dst net 209.161.248.39/32 && ip proto 17 && dst port 22,
		allow  dst net 209.161.248.39/32 && ip proto 17 && dst port 2105,
		allow  dst net 209.161.248.60/32 && ip proto 17 && dst port 80,
		allow  dst net 209.161.248.59/32 && ip proto 17 && dst port 161,
		allow  dst net 209.161.248.59/32 && ip proto 17 && dst port 80,
		allow  dst net 209.161.248.56/32 && ip proto 17 && dst port 7648,
		allow  dst net 209.161.248.56/32 && ip proto 17 && dst port 25,
		allow  dst net 209.161.248.56/32 && ip proto 17 && dst port 22,
		allow  dst net 209.161.248.56/32 && ip proto 17 && dst port 110,
		allow  dst net 209.161.195.98/32 && ip proto 17 && dst port 1999,
		allow  dst net 209.161.195.98/32 && ip proto 17 && dst port 110,
		allow  dst net 209.161.192.97/32 && ip proto 17 && dst port 37,
		allow  dst net 209.161.192.97/32 && ip proto 17 && dst port 88,
		allow  dst net 209.161.192.246/32 && ip proto 17 && dst port 53,
		allow  dst net 209.161.192.246/32 && ip proto 17 && dst port 22,
		allow  dst net 209.161.192.251/32 && ip proto 17 && dst port 179,
		allow  dst net 209.161.192.251/32 && ip proto 17 && dst port 123,
		allow  dst net 209.161.192.251/32 && ip proto 17 && dst port 7648,
		allow  dst net 209.161.192.251/32 && ip proto 17 && dst port 22,
		allow  dst net 209.161.192.251/32 && ip proto 17 && dst port 5999,
		allow  dst net 209.161.192.251/32 && ip proto 17 && dst port 750,
		allow  dst net 209.161.198.78/32 && ip proto 17 && dst port 22,
		allow  dst net 209.161.198.177/32 && ip proto 6 && dst port 53,
		allow  dst net 209.161.199.245/32 && ip proto 17 && dst port 24032,
		allow  dst net 209.161.199.221/32 && ip proto 6 && dst port 5998,
		allow  dst net 209.161.199.221/32 && ip proto 17 && dst port 123,
		allow  dst net 209.161.199.146/32 && ip proto 6 && dst port 22,
		allow  dst net 209.161.199.145/32 && ip proto 17 && dst port 5998,
		allow  dst net 209.161.199.165/32 && ip proto 17 && dst port 22,
		allow  dst net 209.161.199.172/32 && ip proto 6 && dst port 22,
		allow  dst net 209.161.199.172/32 && ip proto 17 && dst port 80,
		allow  dst net 209.161.199.172/32 && ip proto 17 && dst port 22,
		allow  src net 223.95.160.232/32 && ip proto 17 && src port 53,
		allow  src net 209.161.250.145/32 && ip proto 17 && src port 123,
		allow  src net 209.161.250.144/32 && ip proto 17 && src port 53,
		allow  src net 209.161.250.144/32 && ip proto 17 && src port 7648,
		allow  src net 209.161.198.161/32 && ip proto 17 && src port 161,
		allow  src net 209.192.9.126/32 && ip proto 17 && src port 123,
		allow  src net 209.192.8.230/32 && ip proto 17 && src port 750,
		allow  src net 209.192.8.11/32 && ip proto 17 && src port 53,
		allow  src net 202.97.31.178/32 && ip proto 17 && src port 123,
		allow  src net 202.97.30.175/32 && ip proto 17 && src port 161,
		allow  src net 202.97.30.175/32 && ip proto 17 && src port 750,
		allow  src net 202.97.30.175/32 && ip proto 17 && src port 88,
		allow  src net 202.97.30.165/32 && ip proto 17 && src port 161,
		allow  src net 202.97.30.163/32 && ip proto 17 && src port 88,
		allow  src net 203.124.178.60/32 && ip proto 17 && src port 53,
		allow  src net 203.124.136.116/32 && ip proto 17 && src port 7648,
		allow  src net 203.124.136.116/32 && ip proto 17 && src port 750,
		allow  src net 203.124.136.116/32 && ip proto 17 && src port 69,
		allow  src net 203.124.136.116/32 && ip proto 17 && src port 53,
		allow  src net 175.54.90.34/32 && ip proto 17 && src port 67,
		allow  src net 175.54.90.34/32 && ip proto 17 && src port 123,
		allow  src net 175.54.90.34/32 && ip proto 17 && src port 53,
		allow  src net 175.54.90.34/32 && ip proto 17 && src port 161,
		allow  src net 175.54.90.217/32 && ip proto 17 && src port 123,
		allow  src net 175.54.90.207/32 && ip proto 17 && src port 123,
		allow  src net 175.54.90.206/32 && ip proto 17 && src port 24032,
		allow  src net 175.54.90.234/32 && ip proto 17 && src port 750,
		allow  src net 175.54.90.234/32 && ip proto 17 && src port 53,
		allow  src net 175.54.96.171/32 && ip proto 17 && src port 162,
		allow  src net 175.54.96.171/32 && ip proto 17 && src port 53,
		allow  src net 175.54.96.171/32 && ip proto 17 && src port 69,
		allow  src net 175.54.96.171/32 && ip proto 17 && src port 750,
		allow  src net 175.54.96.171/32 && ip proto 17 && src port 161,
		allow  src net 175.54.96.171/32 && ip proto 17 && src port 123,
		allow  src net 175.54.96.171/32 && ip proto 17 && src port 24032,
		allow  src net 6.188.134.10/32 && ip proto 17 && src port 161,
		allow  src net 6.188.134.10/32 && ip proto 17 && src port 53,
		allow  src net 6.188.134.10/32 && ip proto 17 && src port 24032,
		allow  src net 6.188.134.10/32 && ip proto 17 && src port 69,
		allow  src net 6.188.134.10/32 && ip proto 17 && src port 750,
		allow  src net 6.188.134.10/32 && ip proto 17 && src port 123,
		allow  src net 78.59.69.8/32 && ip proto 17 && src port 88,
		allow  src net 64.128.45.59/32 && ip proto 17 && src port 67,
		allow  src net 64.128.45.247/32 && ip proto 17 && src port 750,
		allow  src net 64.128.44.224/32 && ip proto 17 && src port 161,
		allow  src net 64.128.44.224/32 && ip proto 17 && src port 69,
		allow  src net 64.128.44.224/32 && ip proto 17 && src port 123,
		allow  src net 64.128.44.224/32 && ip proto 17 && src port 53,
		allow  src net 65.170.11.72/32 && ip proto 17 && src port 750,
		allow  src net 65.170.11.72/32 && ip proto 17 && src port 53,
		allow  src net 65.170.11.72/32 && ip proto 17 && src port 67,
		allow  src net 89.66.134.193/32 && ip proto 17 && src port 123,
		allow  src net 89.66.134.210/32 && ip proto 17 && src port 123,
		allow  src net 89.66.135.119/32 && ip proto 17 && src port 67,
		allow  src net 89.66.135.119/32 && ip proto 17 && src port 88,
		allow  src net 89.178.104.114/32 && ip proto 17 && src port 123,
		allow  src net 89.178.104.114/32 && ip proto 17 && src port 7648,
		allow  src net 89.178.104.114/32 && ip proto 17 && src port 24032,
		allow  src net 89.178.104.114/32 && ip proto 17 && src port 161,
		allow  dst net 5.220.149.200/32 && ip proto 17 && src port 750,
		allow  dst net 5.220.187.37/32 && ip proto 17 && src port 123,
		allow  dst net 5.220.186.19/32 && ip proto 17 && src port 88,
		allow  dst net 89.178.107.131/32 && ip proto 17 && src port 123,
		allow  dst net 89.178.107.186/32 && ip proto 17 && src port 24032,
		allow  dst net 175.54.90.255/32 && ip proto 17 && src port 161,
		allow  dst net 175.54.102.169/32 && ip proto 17 && src port 7648,
		allow  dst net 175.54.102.174/32 && ip proto 17 && src port 69,
		allow  dst net 209.161.248.137/32 && ip proto 17 && src port 162,
		allow  dst net 209.161.248.56/32 && ip proto 17 && src port 161,
		allow  dst net 89.178.111.192/27 && ip proto 17 && dst port 22,
		allow  dst net 209.161.192.224/27 && ip proto 17 && dst port 53,
		allow  dst net 5.220.149.203/32 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  dst net 5.220.187.37/32 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  dst net 5.220.186.148/32 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  dst net 89.178.107.180/32 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  dst net 89.178.107.186/32 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  dst net 89.178.111.221/32 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  dst net 175.54.93.146/32 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  dst net 175.54.102.169/32 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  dst net 175.54.102.172/32 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  dst net 175.54.102.165/32 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  dst net 209.161.248.39/32 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  dst net 209.161.192.73/32 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  dst net 209.161.198.177/32 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  dst net 209.161.198.163/32 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  dst net 209.161.199.221/32 && ip proto 6 && src port > 1024 && dst port > 1024,
		allow  src net 209.161.199.206/32 && ip proto 6,
		allow  src net 209.161.199.244/32 && ip proto 6,
		allow  src net 209.192.9.126/32 && ip proto 6,
		allow  src net 209.192.8.217/32 && ip proto 6,
		allow  src net 203.124.136.116/32 && ip proto 6,
		allow  src net 175.54.96.171/32 && ip proto 6,
		allow  src net 6.188.134.10/32 && ip proto 6,
		allow  src net 64.128.44.224/32 && ip proto 6,
		allow  src net 65.170.11.95/32 && ip proto 6,
		allow  src net 89.66.134.213/32 && ip proto 6,
		allow  src net 89.178.104.114/32 && ip proto 6,
		allow  dst net 5.220.149.203/32 && ip proto 17 && src port > 1024 && dst port > 1024,
		allow  dst net 5.220.187.37/32 && ip proto 17 && src port > 1024 && dst port > 1024,
		allow  dst net 5.220.186.19/32 && ip proto 17 && src port > 1024 && dst port > 1024,
		allow  dst net 5.220.186.224/32 && ip proto 17 && src port > 1024 && dst port > 1024,
		allow  dst net 89.178.111.245/32 && ip proto 17 && src port > 1024 && dst port > 1024,
		allow  dst net 89.178.111.221/32 && ip proto 17 && src port > 1024 && dst port > 1024,
		allow  dst net 175.54.93.146/32 && ip proto 17 && src port > 1024 && dst port > 1024,
		allow  dst net 175.54.102.165/32 && ip proto 17 && src port > 1024 && dst port > 1024,
		allow  dst net 209.161.248.60/32 && ip proto 17 && src port > 1024 && dst port > 1024,
		allow  dst net 209.161.198.73/32 && ip proto 17 && src port > 1024 && dst port > 1024,
		allow  dst net 5.220.149.203/32 && ip proto 6,
		allow  src net 202.97.30.160/30 && ip proto 6,
		allow  src net 203.124.136.116/30 && ip proto 6,
		allow  src net 175.54.90.192/30 && ip proto 6,
		allow  src net 175.54.96.172/30 && ip proto 6,
		allow  src net 89.66.135.120/30 && ip proto 6,
		allow  src net 89.178.104.116/30 && ip proto 6,
		allow  src net 209.161.250.144/29 && ip proto 6,
		allow  src net 6.188.134.0/29 && ip proto 6,
		allow  src net 13.175.50.96/28 && ip proto 6,
		allow  src net 89.178.104.96/28 && ip proto 6,
		allow  src net 203.124.178.32/27 && ip proto 6,
		allow  src net 203.124.136.96/27 && ip proto 6,
		allow  src net 175.54.90.0/27 && ip proto 6,
		allow  src net 175.54.96.192/26 && ip proto 6,
		allow  src net 202.97.30.0/23 && ip proto 6,
		allow  src net 175.54.98.0/23 && ip proto 6,
		allow  src net 6.188.132.0/23 && ip proto 6,
		allow  src net 89.178.106.0/23 && ip proto 6,
		allow  src net 209.161.192.0/21 && ip proto 6,
		allow  src net 175.54.88.0/21 && ip proto 6,
		allow  src net 175.54.96.0/21 && ip proto 6,
		drop  src net 65.170.11.64/30,
		drop  src net 89.178.104.116/30,
		drop  src net 13.175.50.32/27,
		allow  ip proto 6 && dst port 137,
		allow  ip proto 6 && dst port 25,
		allow  ip proto 6 && dst port 1999,
		allow  ip proto 6 && dst port 544,
		allow  ip proto 6 && dst port 22,
		allow  ip proto 6 && dst port 53,
		allow  ip proto 6 && dst port 80,
		allow  ip proto 6 && dst port 754,
		allow  ip proto 6 && dst port 67,
		allow  ip proto 6 && dst port 750,
		allow  ip proto 6 && dst port 162,
		allow  ip proto 6 && dst port 88,
		allow  src net 89.178.0.0/16 && ip proto 6,
		allow  ip proto 17 && src port 750,
		allow  ip proto 17 && src port 7648,
		allow  ip proto 17 && src port 53,
		allow  ip proto 17 && src port 123,
		allow  ip proto 17 && dst port 750,
		allow  ip proto 17 && dst port 123,
		allow  ip proto 17 && dst port 21,
		allow  ip proto 17 && dst port 25,
		allow  ip proto 17 && dst port 754,
		allow  ip proto 17 && dst port 443,
		allow  src net 175.48.0.0/12 && ip proto 6,
		allow  src net 6.176.0.0/12 && ip proto 6,
		allow  ip proto 17 && src port > 1024 && dst port > 33434 && dst port < 33600,
		allow  ip proto 17 && src port > 33434 && src port < 33600 && dst port > 1024,
		allow  src net 89.0.0.0/8 && ip proto 6,
		allow  ip proto 6,
		drop
	);

	// Strip Ethernet header
	strip  :: Strip(14);

	// Mark IP header (necessary after Strip)
	markIPHeader :: MarkIPHeader;

	// Process the IP options field (mandatory based on RFC 791)
	ipOpt1  :: IPGWOptions($ipAddr1);

	// Set source IP
	fixIP1  :: FixIPSrc($ipAddr1);

	// Decrement IP TTL field
	decTTL1 :: DecIPTTL;

	// Fragment packets
	fragIP1 :: IPFragmenter($mtuSize);

	// Packet & Rate Counters
	counter_rx0 :: AverageCounter;
	counter_tx1 :: AverageCounter;

	/////////////////////////////////////////////////////////////////////
	// Interface's pipeline
	/////////////////////////////////////////////////////////////////////
	// Input --> Processing
	in0 -> counter_rx0 -> strip;

	// --> Way out
	etherEncap1 -> counter_tx1 -> queue1 -> out1;

	// Get IP address for routing
	strip
		-> markIPHeader
		-> filter
		-> DropBroadcasts
		-> ipOpt1[0]
		-> fixIP1
		-> decTTL1[0]
		-> fragIP1[0]
		//-> IPPrint(FW, TTL true)
		-> [0]etherEncap1;

	// Discarded by firewall
	filter[1] -> Discard;
	/////////////////////////////////////////////////////////////////////

	// Save useful counters
	DriverManager(
		wait,

		print >> nf_rate.dat "In     Rate nf"$(position)": "$(counter_rx0.rate),
		print >> nf_rate.dat "In  Counter nf"$(position)": "$(counter_rx0.count),
		print >> nf_rate.dat "Out    Rate nf"$(position)": "$(counter_tx1.rate),
		print >> nf_rate.dat "Out Counter nf"$(position)": "$(counter_tx1.count),
		print >> nf_rate.dat "",

		wait 0.5s,
		stop
	);
}
/////////////////////////////////////////////////////////////////////////////


/////////////////////////////////////////////////////////////////////////////
// Scenario
/////////////////////////////////////////////////////////////////////////////
firewall :: Firewall(
	$iface0, $macAddr0, $ipAddr0, $ipNetHost0, $ipBcast0, $ipNet0, $color0,
	$iface1, $macAddr1, $ipAddr1, $ipNetHost1, $ipBcast1, $ipNet1, $color1,
	$gwIPAddr, $gwMACAddr, $gwPort, $queueSize, $mtuSize, $burst, $io_method,
	$position
);
/////////////////////////////////////////////////////////////////////////////
