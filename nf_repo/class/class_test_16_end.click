/////////////////////////////////////////////////////////////////////////////
// Configuration
define(
	$iface0      em4,
	$macAddr0    ec:f4:bb:d5:fe:d5,
	$ipAddr0     100.0.0.1,
	$ipNetHost0  100.0.0.0/32,
	$ipBcast0    100.0.0.255/32,
	$ipNet0      100.0.0.0/24,
	$color0      1,

	$iface1      eth0,
	$macAddr1    00:60:6e:d5:8a:b8,
	$ipAddr1     200.0.0.1,
	$ipNetHost1  200.0.0.0/32,
	$ipBcast1    200.0.0.255/32,
	$ipNet1      200.0.0.0/24,
	$color1      2,

	$gwIPAddr    200.0.0.2,
	$gwMACAddr   00:00:00:00:00:04,
	$gwPort      2,

	$queueSize   1000000,
	$mtuSize     9000,
	$burst       8
);
/////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////
// Elements
elementclass IPClassifierBench {
	// Module's arguments
	$iface0, $macAddr0,  $ipAddr0, $ipNetHost0, $ipBcast0, $ipNet0, $color0,
	$iface1, $macAddr1,  $ipAddr1, $ipNetHost1, $ipBcast1, $ipNet1, $color1,
	$gwIPAddr, $gwMACAddr, $gwPort, $queueSize, $mtuSize, $burst, $io_method |

	// Queues
	queue :: Queue($queueSize);

	// Module's I/O
	in  :: FromDevice($iface0, BURST $burst);
	out :: ToDevice  ($iface1, BURST $burst);
	
	// ARP Querier
	etherEncap :: EtherEncap(0x0800, $macAddr1, $gwMACAddr);

	// Strip Ethernet header
	strip :: Strip(14);

	// Check IP header's integrity
	markIPHeader :: MarkIPHeader;

	// Measure the incoming pkt rate
	getRate :: AverageCounter;

	/////////////////////////////////////////////////////////////////////
	// Interface's pipeline
	/////////////////////////////////////////////////////////////////////
	// Input
	in -> getRate -> strip;

	// Output
	Idle -> etherEncap -> queue -> out;

	
ipclassifier :: IPClassifier(
	((dst port 9725) || (dst port 20421) || (dst port 55742) || (dst port 56855) || (dst port 63369)) && ((dst net 16.0.0.0/19) || (dst net 16.0.32.0/20) || (dst net 16.0.48.0/21) || (dst net 16.0.56.0/23) || (dst net 16.0.58.0/24) || (dst net 16.0.59.0/26) || (dst net 16.0.59.64/27) || (dst net 16.0.59.96/29) || (dst net 16.0.59.104/32) || (dst net 16.0.59.106/31) || (dst net 16.0.59.108/30) || (dst net 16.0.59.112/28) || (dst net 16.0.59.128/25) || (dst net 16.0.60.0/22) || (dst net 16.0.64.0/19) || (dst net 16.0.96.0/22) || (dst net 16.0.100.0/23) || (dst net 16.0.102.0/24) || (dst net 16.0.103.0/26) || (dst net 16.0.103.64/28) || (dst net 16.0.103.80/32) || (dst net 16.0.103.82/31) || (dst net 16.0.103.84/30) || (dst net 16.0.103.88/29) || (dst net 16.0.103.96/27) || (dst net 16.0.103.128/25) || (dst net 16.0.104.0/22) || (dst net 16.0.108.0/23) || (dst net 16.0.110.0/27) || (dst net 16.0.110.32/28) || (dst net 16.0.110.48/29) || (dst net 16.0.110.56/30) || (dst net 16.0.110.60/32) || (dst net 16.0.110.62/31) || (dst net 16.0.110.64/26) || (dst net 16.0.110.128/25) || (dst net 16.0.111.0/24) || (dst net 16.0.112.0/20) || (dst net 16.0.128.0/21) || (dst net 16.0.136.0/24) || (dst net 16.0.137.0/26) || (dst net 16.0.137.64/28) || (dst net 16.0.137.80/29) || (dst net 16.0.137.88/31) || (dst net 16.0.137.91/32) || (dst net 16.0.137.92/30) || (dst net 16.0.137.96/27) || (dst net 16.0.137.128/25) || (dst net 16.0.138.0/23) || (dst net 16.0.140.0/22) || (dst net 16.0.144.0/20) || (dst net 16.0.160.0/19) || (dst net 16.0.192.0/19) || (dst net 16.0.224.0/20) || (dst net 16.0.240.0/21) || (dst net 16.0.248.0/22) || (dst net 16.0.252.0/25) || (dst net 16.0.252.128/26) || (dst net 16.0.252.192/31) || (dst net 16.0.252.194/32) || (dst net 16.0.252.196/30) || (dst net 16.0.252.200/29) || (dst net 16.0.252.208/28) || (dst net 16.0.252.224/27) || (dst net 16.0.253.0/24) || (dst net 16.0.254.0/23) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 10434) || (dst port 35491) || (dst port 37540) || (dst port 53440) || (dst port 61949)) && ((dst net 16.0.0.0/18) || (dst net 16.0.64.0/19) || (dst net 16.0.96.0/20) || (dst net 16.0.112.0/22) || (dst net 16.0.116.0/23) || (dst net 16.0.118.0/24) || (dst net 16.0.119.0/25) || (dst net 16.0.119.128/26) || (dst net 16.0.119.192/28) || (dst net 16.0.119.208/30) || (dst net 16.0.119.213/32) || (dst net 16.0.119.214/31) || (dst net 16.0.119.216/29) || (dst net 16.0.119.224/27) || (dst net 16.0.120.0/21) || (dst net 16.0.128.0/19) || (dst net 16.0.160.0/23) || (dst net 16.0.162.0/24) || (dst net 16.0.163.0/25) || (dst net 16.0.163.128/27) || (dst net 16.0.163.160/28) || (dst net 16.0.163.176/29) || (dst net 16.0.163.184/32) || (dst net 16.0.163.186/31) || (dst net 16.0.163.188/30) || (dst net 16.0.163.192/26) || (dst net 16.0.164.0/22) || (dst net 16.0.168.0/21) || (dst net 16.0.176.0/25) || (dst net 16.0.176.128/26) || (dst net 16.0.176.192/28) || (dst net 16.0.176.208/30) || (dst net 16.0.176.212/31) || (dst net 16.0.176.214/32) || (dst net 16.0.176.216/29) || (dst net 16.0.176.224/27) || (dst net 16.0.177.0/24) || (dst net 16.0.178.0/23) || (dst net 16.0.180.0/22) || (dst net 16.0.184.0/21) || (dst net 16.0.192.0/19) || (dst net 16.0.224.0/21) || (dst net 16.0.232.0/22) || (dst net 16.0.236.0/23) || (dst net 16.0.238.0/25) || (dst net 16.0.238.128/28) || (dst net 16.0.238.144/31) || (dst net 16.0.238.146/32) || (dst net 16.0.238.148/30) || (dst net 16.0.238.152/29) || (dst net 16.0.238.160/27) || (dst net 16.0.238.192/26) || (dst net 16.0.239.0/24) || (dst net 16.0.240.0/21) || (dst net 16.0.248.0/22) || (dst net 16.0.252.0/23) || (dst net 16.0.254.0/24) || (dst net 16.0.255.0/26) || (dst net 16.0.255.64/27) || (dst net 16.0.255.96/30) || (dst net 16.0.255.101/32) || (dst net 16.0.255.102/31) || (dst net 16.0.255.104/29) || (dst net 16.0.255.112/28) || (dst net 16.0.255.128/25) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 1468) || (dst port 6326) || (dst port 33999) || (dst port 36798) || (dst port 56157)) && ((dst net 16.0.0.0/21) || (dst net 16.0.8.0/23) || (dst net 16.0.10.0/25) || (dst net 16.0.10.128/31) || (dst net 16.0.10.130/32) || (dst net 16.0.10.132/30) || (dst net 16.0.10.136/29) || (dst net 16.0.10.144/28) || (dst net 16.0.10.160/27) || (dst net 16.0.10.192/26) || (dst net 16.0.11.0/24) || (dst net 16.0.12.0/22) || (dst net 16.0.16.0/21) || (dst net 16.0.24.0/22) || (dst net 16.0.28.0/27) || (dst net 16.0.28.32/29) || (dst net 16.0.28.40/31) || (dst net 16.0.28.43/32) || (dst net 16.0.28.44/30) || (dst net 16.0.28.48/28) || (dst net 16.0.28.64/26) || (dst net 16.0.28.128/25) || (dst net 16.0.29.0/24) || (dst net 16.0.30.0/23) || (dst net 16.0.32.0/22) || (dst net 16.0.36.0/23) || (dst net 16.0.38.0/24) || (dst net 16.0.39.0/25) || (dst net 16.0.39.128/26) || (dst net 16.0.39.192/29) || (dst net 16.0.39.200/32) || (dst net 16.0.39.202/31) || (dst net 16.0.39.204/30) || (dst net 16.0.39.208/28) || (dst net 16.0.39.224/27) || (dst net 16.0.40.0/21) || (dst net 16.0.48.0/20) || (dst net 16.0.64.0/20) || (dst net 16.0.80.0/22) || (dst net 16.0.84.0/23) || (dst net 16.0.86.0/24) || (dst net 16.0.87.0/25) || (dst net 16.0.87.128/26) || (dst net 16.0.87.192/27) || (dst net 16.0.87.224/28) || (dst net 16.0.87.240/30) || (dst net 16.0.87.244/31) || (dst net 16.0.87.246/32) || (dst net 16.0.87.248/29) || (dst net 16.0.88.0/21) || (dst net 16.0.96.0/19) || (dst net 16.0.128.0/18) || (dst net 16.0.192.0/20) || (dst net 16.0.208.0/23) || (dst net 16.0.210.0/26) || (dst net 16.0.210.64/30) || (dst net 16.0.210.69/32) || (dst net 16.0.210.70/31) || (dst net 16.0.210.72/29) || (dst net 16.0.210.80/28) || (dst net 16.0.210.96/27) || (dst net 16.0.210.128/25) || (dst net 16.0.211.0/24) || (dst net 16.0.212.0/22) || (dst net 16.0.216.0/21) || (dst net 16.0.224.0/19) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 4344) || (dst port 9221) || (dst port 12582) || (dst port 22667) || (dst port 43975)) && ((dst net 16.0.0.0/22) || (dst net 16.0.4.0/24) || (dst net 16.0.5.0/25) || (dst net 16.0.5.128/26) || (dst net 16.0.5.192/28) || (dst net 16.0.5.208/30) || (dst net 16.0.5.212/31) || (dst net 16.0.5.215/32) || (dst net 16.0.5.216/29) || (dst net 16.0.5.224/27) || (dst net 16.0.6.0/23) || (dst net 16.0.8.0/21) || (dst net 16.0.16.0/20) || (dst net 16.0.32.0/19) || (dst net 16.0.64.0/18) || (dst net 16.0.128.0/22) || (dst net 16.0.132.0/26) || (dst net 16.0.132.64/28) || (dst net 16.0.132.80/30) || (dst net 16.0.132.84/32) || (dst net 16.0.132.86/31) || (dst net 16.0.132.88/29) || (dst net 16.0.132.96/27) || (dst net 16.0.132.128/25) || (dst net 16.0.133.0/24) || (dst net 16.0.134.0/23) || (dst net 16.0.136.0/21) || (dst net 16.0.144.0/20) || (dst net 16.0.160.0/21) || (dst net 16.0.168.0/22) || (dst net 16.0.172.0/25) || (dst net 16.0.172.128/27) || (dst net 16.0.172.160/29) || (dst net 16.0.172.168/30) || (dst net 16.0.172.172/31) || (dst net 16.0.172.174/32) || (dst net 16.0.172.176/28) || (dst net 16.0.172.192/26) || (dst net 16.0.173.0/24) || (dst net 16.0.174.0/23) || (dst net 16.0.176.0/23) || (dst net 16.0.178.0/25) || (dst net 16.0.178.128/26) || (dst net 16.0.178.192/29) || (dst net 16.0.178.200/30) || (dst net 16.0.178.204/31) || (dst net 16.0.178.206/32) || (dst net 16.0.178.208/28) || (dst net 16.0.178.224/27) || (dst net 16.0.179.0/24) || (dst net 16.0.180.0/22) || (dst net 16.0.184.0/22) || (dst net 16.0.188.0/25) || (dst net 16.0.188.128/27) || (dst net 16.0.188.160/28) || (dst net 16.0.188.176/29) || (dst net 16.0.188.185/32) || (dst net 16.0.188.186/31) || (dst net 16.0.188.188/30) || (dst net 16.0.188.192/26) || (dst net 16.0.189.0/24) || (dst net 16.0.190.0/23) || (dst net 16.0.192.0/18) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 1726) || (dst port 5067) || (dst port 45295) || (dst port 46774) || (dst port 49962)) && ((dst net 16.0.0.0/19) || (dst net 16.0.32.0/21) || (dst net 16.0.40.0/23) || (dst net 16.0.42.0/25) || (dst net 16.0.42.128/26) || (dst net 16.0.42.192/28) || (dst net 16.0.42.208/30) || (dst net 16.0.42.212/32) || (dst net 16.0.42.214/31) || (dst net 16.0.42.216/29) || (dst net 16.0.42.224/27) || (dst net 16.0.43.0/24) || (dst net 16.0.44.0/22) || (dst net 16.0.48.0/21) || (dst net 16.0.56.0/25) || (dst net 16.0.56.128/27) || (dst net 16.0.56.160/28) || (dst net 16.0.56.176/29) || (dst net 16.0.56.184/30) || (dst net 16.0.56.188/31) || (dst net 16.0.56.191/32) || (dst net 16.0.56.192/26) || (dst net 16.0.57.0/24) || (dst net 16.0.58.0/23) || (dst net 16.0.60.0/22) || (dst net 16.0.64.0/19) || (dst net 16.0.96.0/24) || (dst net 16.0.97.0/26) || (dst net 16.0.97.64/29) || (dst net 16.0.97.72/30) || (dst net 16.0.97.76/31) || (dst net 16.0.97.78/32) || (dst net 16.0.97.80/28) || (dst net 16.0.97.96/27) || (dst net 16.0.97.128/25) || (dst net 16.0.98.0/23) || (dst net 16.0.100.0/22) || (dst net 16.0.104.0/21) || (dst net 16.0.112.0/20) || (dst net 16.0.128.0/20) || (dst net 16.0.144.0/22) || (dst net 16.0.148.0/23) || (dst net 16.0.150.0/30) || (dst net 16.0.150.4/31) || (dst net 16.0.150.7/32) || (dst net 16.0.150.8/29) || (dst net 16.0.150.16/28) || (dst net 16.0.150.32/27) || (dst net 16.0.150.64/26) || (dst net 16.0.150.128/25) || (dst net 16.0.151.0/24) || (dst net 16.0.152.0/21) || (dst net 16.0.160.0/19) || (dst net 16.0.192.0/19) || (dst net 16.0.224.0/21) || (dst net 16.0.232.0/23) || (dst net 16.0.234.0/24) || (dst net 16.0.235.0/25) || (dst net 16.0.235.128/26) || (dst net 16.0.235.192/28) || (dst net 16.0.235.209/32) || (dst net 16.0.235.210/31) || (dst net 16.0.235.212/30) || (dst net 16.0.235.216/29) || (dst net 16.0.235.224/27) || (dst net 16.0.236.0/22) || (dst net 16.0.240.0/20) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 34036) || (dst port 39430) || (dst port 47438) || (dst port 54478) || (dst port 60244)) && ((dst net 16.0.0.0/18) || (dst net 16.0.64.0/19) || (dst net 16.0.96.0/21) || (dst net 16.0.104.0/22) || (dst net 16.0.108.0/23) || (dst net 16.0.110.0/27) || (dst net 16.0.110.32/28) || (dst net 16.0.110.48/31) || (dst net 16.0.110.51/32) || (dst net 16.0.110.52/30) || (dst net 16.0.110.56/29) || (dst net 16.0.110.64/26) || (dst net 16.0.110.128/25) || (dst net 16.0.111.0/24) || (dst net 16.0.112.0/20) || (dst net 16.0.128.0/24) || (dst net 16.0.129.0/25) || (dst net 16.0.129.128/29) || (dst net 16.0.129.137/32) || (dst net 16.0.129.138/31) || (dst net 16.0.129.140/30) || (dst net 16.0.129.144/28) || (dst net 16.0.129.160/27) || (dst net 16.0.129.192/26) || (dst net 16.0.130.0/23) || (dst net 16.0.132.0/22) || (dst net 16.0.136.0/21) || (dst net 16.0.144.0/22) || (dst net 16.0.148.0/23) || (dst net 16.0.150.0/25) || (dst net 16.0.150.128/26) || (dst net 16.0.150.192/27) || (dst net 16.0.150.224/28) || (dst net 16.0.150.240/29) || (dst net 16.0.150.248/30) || (dst net 16.0.150.252/31) || (dst net 16.0.150.255/32) || (dst net 16.0.151.0/24) || (dst net 16.0.152.0/21) || (dst net 16.0.160.0/19) || (dst net 16.0.192.0/19) || (dst net 16.0.224.0/21) || (dst net 16.0.232.0/22) || (dst net 16.0.236.0/25) || (dst net 16.0.236.128/26) || (dst net 16.0.236.192/27) || (dst net 16.0.236.224/29) || (dst net 16.0.236.232/30) || (dst net 16.0.236.236/31) || (dst net 16.0.236.238/32) || (dst net 16.0.236.240/28) || (dst net 16.0.237.0/24) || (dst net 16.0.238.0/31) || (dst net 16.0.238.3/32) || (dst net 16.0.238.4/30) || (dst net 16.0.238.8/29) || (dst net 16.0.238.16/28) || (dst net 16.0.238.32/27) || (dst net 16.0.238.64/26) || (dst net 16.0.238.128/25) || (dst net 16.0.239.0/24) || (dst net 16.0.240.0/20) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 6385) || (dst port 34828) || (dst port 35963) || (dst port 43717) || (dst port 45782)) && ((dst net 16.0.0.0/19) || (dst net 16.0.32.0/21) || (dst net 16.0.40.0/24) || (dst net 16.0.41.0/26) || (dst net 16.0.41.64/28) || (dst net 16.0.41.80/31) || (dst net 16.0.41.82/32) || (dst net 16.0.41.84/30) || (dst net 16.0.41.88/29) || (dst net 16.0.41.96/27) || (dst net 16.0.41.128/25) || (dst net 16.0.42.0/23) || (dst net 16.0.44.0/22) || (dst net 16.0.48.0/20) || (dst net 16.0.64.0/22) || (dst net 16.0.68.0/24) || (dst net 16.0.69.0/25) || (dst net 16.0.69.128/26) || (dst net 16.0.69.192/27) || (dst net 16.0.69.224/28) || (dst net 16.0.69.240/30) || (dst net 16.0.69.245/32) || (dst net 16.0.69.246/31) || (dst net 16.0.69.248/29) || (dst net 16.0.70.0/23) || (dst net 16.0.72.0/21) || (dst net 16.0.80.0/20) || (dst net 16.0.96.0/20) || (dst net 16.0.112.0/21) || (dst net 16.0.120.0/22) || (dst net 16.0.124.0/24) || (dst net 16.0.125.0/25) || (dst net 16.0.125.128/27) || (dst net 16.0.125.160/30) || (dst net 16.0.125.164/31) || (dst net 16.0.125.166/32) || (dst net 16.0.125.168/29) || (dst net 16.0.125.176/28) || (dst net 16.0.125.192/26) || (dst net 16.0.126.0/23) || (dst net 16.0.128.0/20) || (dst net 16.0.144.0/23) || (dst net 16.0.146.0/24) || (dst net 16.0.147.0/29) || (dst net 16.0.147.8/31) || (dst net 16.0.147.11/32) || (dst net 16.0.147.12/30) || (dst net 16.0.147.16/28) || (dst net 16.0.147.32/27) || (dst net 16.0.147.64/26) || (dst net 16.0.147.128/25) || (dst net 16.0.148.0/22) || (dst net 16.0.152.0/21) || (dst net 16.0.160.0/19) || (dst net 16.0.192.0/19) || (dst net 16.0.224.0/20) || (dst net 16.0.240.0/21) || (dst net 16.0.248.0/24) || (dst net 16.0.249.0/25) || (dst net 16.0.249.128/26) || (dst net 16.0.249.192/27) || (dst net 16.0.249.224/30) || (dst net 16.0.249.229/32) || (dst net 16.0.249.230/31) || (dst net 16.0.249.232/29) || (dst net 16.0.249.240/28) || (dst net 16.0.250.0/23) || (dst net 16.0.252.0/22) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 2074) || (dst port 9910) || (dst port 28922) || (dst port 32918) || (dst port 47932)) && ((dst net 16.0.0.0/18) || (dst net 16.0.64.0/19) || (dst net 16.0.96.0/20) || (dst net 16.0.112.0/21) || (dst net 16.0.120.0/22) || (dst net 16.0.124.0/23) || (dst net 16.0.126.0/25) || (dst net 16.0.126.128/26) || (dst net 16.0.126.192/32) || (dst net 16.0.126.194/31) || (dst net 16.0.126.196/30) || (dst net 16.0.126.200/29) || (dst net 16.0.126.208/28) || (dst net 16.0.126.224/27) || (dst net 16.0.127.0/24) || (dst net 16.0.128.0/20) || (dst net 16.0.144.0/23) || (dst net 16.0.146.0/26) || (dst net 16.0.146.64/28) || (dst net 16.0.146.80/30) || (dst net 16.0.146.85/32) || (dst net 16.0.146.86/31) || (dst net 16.0.146.88/29) || (dst net 16.0.146.96/27) || (dst net 16.0.146.128/25) || (dst net 16.0.147.0/24) || (dst net 16.0.148.0/23) || (dst net 16.0.150.0/25) || (dst net 16.0.150.128/26) || (dst net 16.0.150.192/31) || (dst net 16.0.150.195/32) || (dst net 16.0.150.196/30) || (dst net 16.0.150.200/29) || (dst net 16.0.150.208/28) || (dst net 16.0.150.224/27) || (dst net 16.0.151.0/24) || (dst net 16.0.152.0/22) || (dst net 16.0.156.0/26) || (dst net 16.0.156.64/28) || (dst net 16.0.156.80/29) || (dst net 16.0.156.88/31) || (dst net 16.0.156.91/32) || (dst net 16.0.156.92/30) || (dst net 16.0.156.96/27) || (dst net 16.0.156.128/25) || (dst net 16.0.157.0/24) || (dst net 16.0.158.0/23) || (dst net 16.0.160.0/21) || (dst net 16.0.168.0/23) || (dst net 16.0.170.0/24) || (dst net 16.0.171.0/32) || (dst net 16.0.171.2/31) || (dst net 16.0.171.4/30) || (dst net 16.0.171.8/29) || (dst net 16.0.171.16/28) || (dst net 16.0.171.32/27) || (dst net 16.0.171.64/26) || (dst net 16.0.171.128/25) || (dst net 16.0.172.0/22) || (dst net 16.0.176.0/20) || (dst net 16.0.192.0/18) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 7024) || (dst port 25098) || (dst port 36165) || (dst port 39137) || (dst port 40050)) && ((dst net 16.0.0.0/21) || (dst net 16.0.8.0/25) || (dst net 16.0.8.128/26) || (dst net 16.0.8.192/27) || (dst net 16.0.8.224/28) || (dst net 16.0.8.240/29) || (dst net 16.0.8.248/32) || (dst net 16.0.8.250/31) || (dst net 16.0.8.252/30) || (dst net 16.0.9.0/24) || (dst net 16.0.10.0/23) || (dst net 16.0.12.0/24) || (dst net 16.0.13.0/27) || (dst net 16.0.13.32/28) || (dst net 16.0.13.48/30) || (dst net 16.0.13.52/31) || (dst net 16.0.13.55/32) || (dst net 16.0.13.56/29) || (dst net 16.0.13.64/26) || (dst net 16.0.13.128/25) || (dst net 16.0.14.0/23) || (dst net 16.0.16.0/20) || (dst net 16.0.32.0/20) || (dst net 16.0.48.0/21) || (dst net 16.0.56.0/22) || (dst net 16.0.60.0/23) || (dst net 16.0.62.0/25) || (dst net 16.0.62.128/26) || (dst net 16.0.62.192/31) || (dst net 16.0.62.195/32) || (dst net 16.0.62.196/30) || (dst net 16.0.62.200/29) || (dst net 16.0.62.208/28) || (dst net 16.0.62.224/27) || (dst net 16.0.63.0/24) || (dst net 16.0.64.0/20) || (dst net 16.0.80.0/23) || (dst net 16.0.82.0/28) || (dst net 16.0.82.16/30) || (dst net 16.0.82.20/31) || (dst net 16.0.82.23/32) || (dst net 16.0.82.24/29) || (dst net 16.0.82.32/27) || (dst net 16.0.82.64/26) || (dst net 16.0.82.128/25) || (dst net 16.0.83.0/24) || (dst net 16.0.84.0/22) || (dst net 16.0.88.0/21) || (dst net 16.0.96.0/19) || (dst net 16.0.128.0/22) || (dst net 16.0.132.0/24) || (dst net 16.0.133.0/25) || (dst net 16.0.133.128/27) || (dst net 16.0.133.160/30) || (dst net 16.0.133.164/31) || (dst net 16.0.133.167/32) || (dst net 16.0.133.168/29) || (dst net 16.0.133.176/28) || (dst net 16.0.133.192/26) || (dst net 16.0.134.0/23) || (dst net 16.0.136.0/21) || (dst net 16.0.144.0/20) || (dst net 16.0.160.0/19) || (dst net 16.0.192.0/18) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 26709) || (dst port 31444) || (dst port 31907) || (dst port 45679) || (dst port 46561)) && ((dst net 16.0.0.0/18) || (dst net 16.0.64.0/19) || (dst net 16.0.96.0/20) || (dst net 16.0.112.0/21) || (dst net 16.0.120.0/22) || (dst net 16.0.124.0/25) || (dst net 16.0.124.128/28) || (dst net 16.0.124.144/29) || (dst net 16.0.124.153/32) || (dst net 16.0.124.154/31) || (dst net 16.0.124.156/30) || (dst net 16.0.124.160/27) || (dst net 16.0.124.192/26) || (dst net 16.0.125.0/24) || (dst net 16.0.126.0/23) || (dst net 16.0.128.0/23) || (dst net 16.0.130.0/24) || (dst net 16.0.131.0/26) || (dst net 16.0.131.64/28) || (dst net 16.0.131.80/29) || (dst net 16.0.131.88/30) || (dst net 16.0.131.92/31) || (dst net 16.0.131.95/32) || (dst net 16.0.131.96/27) || (dst net 16.0.131.128/25) || (dst net 16.0.132.0/22) || (dst net 16.0.136.0/21) || (dst net 16.0.144.0/20) || (dst net 16.0.160.0/22) || (dst net 16.0.164.0/23) || (dst net 16.0.166.0/26) || (dst net 16.0.166.64/27) || (dst net 16.0.166.96/28) || (dst net 16.0.166.113/32) || (dst net 16.0.166.114/31) || (dst net 16.0.166.116/30) || (dst net 16.0.166.120/29) || (dst net 16.0.166.128/25) || (dst net 16.0.167.0/24) || (dst net 16.0.168.0/21) || (dst net 16.0.176.0/20) || (dst net 16.0.192.0/22) || (dst net 16.0.196.0/24) || (dst net 16.0.197.0/25) || (dst net 16.0.197.128/27) || (dst net 16.0.197.160/30) || (dst net 16.0.197.164/32) || (dst net 16.0.197.166/31) || (dst net 16.0.197.168/29) || (dst net 16.0.197.176/28) || (dst net 16.0.197.192/26) || (dst net 16.0.198.0/23) || (dst net 16.0.200.0/21) || (dst net 16.0.208.0/20) || (dst net 16.0.224.0/21) || (dst net 16.0.232.0/22) || (dst net 16.0.236.0/23) || (dst net 16.0.238.0/24) || (dst net 16.0.239.0/26) || (dst net 16.0.239.64/27) || (dst net 16.0.239.96/29) || (dst net 16.0.239.104/30) || (dst net 16.0.239.108/31) || (dst net 16.0.239.111/32) || (dst net 16.0.239.112/28) || (dst net 16.0.239.128/25) || (dst net 16.0.240.0/20) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 15427) || (dst port 27099) || (dst port 34767) || (dst port 39157) || (dst port 61491)) && ((dst net 16.0.0.0/18) || (dst net 16.0.64.0/22) || (dst net 16.0.68.0/23) || (dst net 16.0.70.0/25) || (dst net 16.0.70.128/26) || (dst net 16.0.70.192/28) || (dst net 16.0.70.208/31) || (dst net 16.0.70.211/32) || (dst net 16.0.70.212/30) || (dst net 16.0.70.216/29) || (dst net 16.0.70.224/27) || (dst net 16.0.71.0/25) || (dst net 16.0.71.128/27) || (dst net 16.0.71.160/28) || (dst net 16.0.71.176/30) || (dst net 16.0.71.180/32) || (dst net 16.0.71.182/31) || (dst net 16.0.71.184/29) || (dst net 16.0.71.192/26) || (dst net 16.0.72.0/21) || (dst net 16.0.80.0/20) || (dst net 16.0.96.0/19) || (dst net 16.0.128.0/21) || (dst net 16.0.136.0/25) || (dst net 16.0.136.128/26) || (dst net 16.0.136.192/31) || (dst net 16.0.136.195/32) || (dst net 16.0.136.196/30) || (dst net 16.0.136.200/29) || (dst net 16.0.136.208/28) || (dst net 16.0.136.224/27) || (dst net 16.0.137.0/24) || (dst net 16.0.138.0/23) || (dst net 16.0.140.0/22) || (dst net 16.0.144.0/21) || (dst net 16.0.152.0/23) || (dst net 16.0.154.0/24) || (dst net 16.0.155.0/30) || (dst net 16.0.155.4/32) || (dst net 16.0.155.6/31) || (dst net 16.0.155.8/29) || (dst net 16.0.155.16/28) || (dst net 16.0.155.32/27) || (dst net 16.0.155.64/26) || (dst net 16.0.155.128/25) || (dst net 16.0.156.0/22) || (dst net 16.0.160.0/20) || (dst net 16.0.176.0/22) || (dst net 16.0.180.0/28) || (dst net 16.0.180.16/32) || (dst net 16.0.180.18/31) || (dst net 16.0.180.20/30) || (dst net 16.0.180.24/29) || (dst net 16.0.180.32/27) || (dst net 16.0.180.64/26) || (dst net 16.0.180.128/25) || (dst net 16.0.181.0/24) || (dst net 16.0.182.0/23) || (dst net 16.0.184.0/21) || (dst net 16.0.192.0/18) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 9416) || (dst port 15091) || (dst port 16477) || (dst port 42698) || (dst port 58952)) && ((dst net 16.0.0.0/17) || (dst net 16.0.128.0/22) || (dst net 16.0.132.0/23) || (dst net 16.0.134.0/24) || (dst net 16.0.135.0/30) || (dst net 16.0.135.4/32) || (dst net 16.0.135.6/31) || (dst net 16.0.135.8/29) || (dst net 16.0.135.16/28) || (dst net 16.0.135.32/27) || (dst net 16.0.135.64/26) || (dst net 16.0.135.128/25) || (dst net 16.0.136.0/21) || (dst net 16.0.144.0/20) || (dst net 16.0.160.0/21) || (dst net 16.0.168.0/22) || (dst net 16.0.172.0/23) || (dst net 16.0.174.0/26) || (dst net 16.0.174.64/27) || (dst net 16.0.174.96/28) || (dst net 16.0.174.112/30) || (dst net 16.0.174.116/31) || (dst net 16.0.174.118/32) || (dst net 16.0.174.120/29) || (dst net 16.0.174.128/25) || (dst net 16.0.175.0/24) || (dst net 16.0.176.0/20) || (dst net 16.0.192.0/21) || (dst net 16.0.200.0/26) || (dst net 16.0.200.64/27) || (dst net 16.0.200.96/28) || (dst net 16.0.200.112/30) || (dst net 16.0.200.117/32) || (dst net 16.0.200.118/31) || (dst net 16.0.200.120/29) || (dst net 16.0.200.128/25) || (dst net 16.0.201.0/24) || (dst net 16.0.202.0/23) || (dst net 16.0.204.0/22) || (dst net 16.0.208.0/23) || (dst net 16.0.210.0/27) || (dst net 16.0.210.32/28) || (dst net 16.0.210.48/29) || (dst net 16.0.210.56/31) || (dst net 16.0.210.59/32) || (dst net 16.0.210.60/30) || (dst net 16.0.210.64/26) || (dst net 16.0.210.128/25) || (dst net 16.0.211.0/24) || (dst net 16.0.212.0/22) || (dst net 16.0.216.0/21) || (dst net 16.0.224.0/21) || (dst net 16.0.232.0/23) || (dst net 16.0.234.0/24) || (dst net 16.0.235.0/25) || (dst net 16.0.235.128/28) || (dst net 16.0.235.144/30) || (dst net 16.0.235.148/31) || (dst net 16.0.235.150/32) || (dst net 16.0.235.152/29) || (dst net 16.0.235.160/27) || (dst net 16.0.235.192/26) || (dst net 16.0.236.0/22) || (dst net 16.0.240.0/20) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 8057) || (dst port 27294) || (dst port 33215) || (dst port 46038) || (dst port 62420)) && ((dst net 16.0.0.0/24) || (dst net 16.0.1.0/27) || (dst net 16.0.1.32/28) || (dst net 16.0.1.48/29) || (dst net 16.0.1.56/31) || (dst net 16.0.1.58/32) || (dst net 16.0.1.60/30) || (dst net 16.0.1.64/26) || (dst net 16.0.1.128/25) || (dst net 16.0.2.0/23) || (dst net 16.0.4.0/22) || (dst net 16.0.8.0/21) || (dst net 16.0.16.0/20) || (dst net 16.0.32.0/19) || (dst net 16.0.64.0/22) || (dst net 16.0.68.0/23) || (dst net 16.0.70.0/26) || (dst net 16.0.70.64/27) || (dst net 16.0.70.96/28) || (dst net 16.0.70.112/29) || (dst net 16.0.70.120/30) || (dst net 16.0.70.124/31) || (dst net 16.0.70.127/32) || (dst net 16.0.70.128/25) || (dst net 16.0.71.0/26) || (dst net 16.0.71.64/27) || (dst net 16.0.71.96/29) || (dst net 16.0.71.105/32) || (dst net 16.0.71.106/31) || (dst net 16.0.71.108/30) || (dst net 16.0.71.112/28) || (dst net 16.0.71.128/25) || (dst net 16.0.72.0/21) || (dst net 16.0.80.0/20) || (dst net 16.0.96.0/19) || (dst net 16.0.128.0/18) || (dst net 16.0.192.0/20) || (dst net 16.0.208.0/21) || (dst net 16.0.216.0/23) || (dst net 16.0.218.0/24) || (dst net 16.0.219.0/25) || (dst net 16.0.219.128/26) || (dst net 16.0.219.192/28) || (dst net 16.0.219.208/29) || (dst net 16.0.219.216/32) || (dst net 16.0.219.218/31) || (dst net 16.0.219.220/30) || (dst net 16.0.219.224/27) || (dst net 16.0.220.0/22) || (dst net 16.0.224.0/21) || (dst net 16.0.232.0/22) || (dst net 16.0.236.0/23) || (dst net 16.0.238.0/24) || (dst net 16.0.239.0/25) || (dst net 16.0.239.128/28) || (dst net 16.0.239.144/29) || (dst net 16.0.239.152/31) || (dst net 16.0.239.154/32) || (dst net 16.0.239.156/30) || (dst net 16.0.239.160/27) || (dst net 16.0.239.192/26) || (dst net 16.0.240.0/20) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 19468) || (dst port 21677) || (dst port 22185) || (dst port 22582) || (dst port 49652)) && ((dst net 16.0.0.0/20) || (dst net 16.0.16.0/21) || (dst net 16.0.24.0/24) || (dst net 16.0.25.0/25) || (dst net 16.0.25.128/28) || (dst net 16.0.25.145/32) || (dst net 16.0.25.146/31) || (dst net 16.0.25.148/30) || (dst net 16.0.25.152/29) || (dst net 16.0.25.160/27) || (dst net 16.0.25.192/26) || (dst net 16.0.26.0/24) || (dst net 16.0.27.0/25) || (dst net 16.0.27.128/28) || (dst net 16.0.27.144/30) || (dst net 16.0.27.149/32) || (dst net 16.0.27.150/31) || (dst net 16.0.27.152/29) || (dst net 16.0.27.160/27) || (dst net 16.0.27.192/26) || (dst net 16.0.28.0/22) || (dst net 16.0.32.0/19) || (dst net 16.0.64.0/19) || (dst net 16.0.96.0/21) || (dst net 16.0.104.0/22) || (dst net 16.0.108.0/23) || (dst net 16.0.110.0/24) || (dst net 16.0.111.0/25) || (dst net 16.0.111.128/27) || (dst net 16.0.111.160/28) || (dst net 16.0.111.176/29) || (dst net 16.0.111.184/30) || (dst net 16.0.111.188/31) || (dst net 16.0.111.191/32) || (dst net 16.0.111.192/26) || (dst net 16.0.112.0/25) || (dst net 16.0.112.128/26) || (dst net 16.0.112.192/27) || (dst net 16.0.112.224/28) || (dst net 16.0.112.240/30) || (dst net 16.0.112.244/31) || (dst net 16.0.112.246/32) || (dst net 16.0.112.248/29) || (dst net 16.0.113.0/24) || (dst net 16.0.114.0/23) || (dst net 16.0.116.0/22) || (dst net 16.0.120.0/21) || (dst net 16.0.128.0/18) || (dst net 16.0.192.0/22) || (dst net 16.0.196.0/27) || (dst net 16.0.196.32/30) || (dst net 16.0.196.36/32) || (dst net 16.0.196.38/31) || (dst net 16.0.196.40/29) || (dst net 16.0.196.48/28) || (dst net 16.0.196.64/26) || (dst net 16.0.196.128/25) || (dst net 16.0.197.0/24) || (dst net 16.0.198.0/23) || (dst net 16.0.200.0/21) || (dst net 16.0.208.0/20) || (dst net 16.0.224.0/19) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 24078) || (dst port 32234) || (dst port 52752) || (dst port 56664) || (dst port 63856)) && ((dst net 16.0.0.0/21) || (dst net 16.0.8.0/22) || (dst net 16.0.12.0/23) || (dst net 16.0.14.0/27) || (dst net 16.0.14.32/28) || (dst net 16.0.14.48/29) || (dst net 16.0.14.56/30) || (dst net 16.0.14.61/32) || (dst net 16.0.14.62/31) || (dst net 16.0.14.64/26) || (dst net 16.0.14.128/25) || (dst net 16.0.15.0/24) || (dst net 16.0.16.0/21) || (dst net 16.0.24.0/22) || (dst net 16.0.28.0/24) || (dst net 16.0.29.0/26) || (dst net 16.0.29.64/29) || (dst net 16.0.29.72/30) || (dst net 16.0.29.76/31) || (dst net 16.0.29.79/32) || (dst net 16.0.29.80/28) || (dst net 16.0.29.96/27) || (dst net 16.0.29.128/25) || (dst net 16.0.30.0/23) || (dst net 16.0.32.0/20) || (dst net 16.0.48.0/23) || (dst net 16.0.50.0/24) || (dst net 16.0.51.0/25) || (dst net 16.0.51.128/26) || (dst net 16.0.51.192/28) || (dst net 16.0.51.208/30) || (dst net 16.0.51.212/31) || (dst net 16.0.51.215/32) || (dst net 16.0.51.216/29) || (dst net 16.0.51.224/27) || (dst net 16.0.52.0/22) || (dst net 16.0.56.0/21) || (dst net 16.0.64.0/19) || (dst net 16.0.96.0/20) || (dst net 16.0.112.0/21) || (dst net 16.0.120.0/22) || (dst net 16.0.124.0/27) || (dst net 16.0.124.32/28) || (dst net 16.0.124.48/29) || (dst net 16.0.124.56/30) || (dst net 16.0.124.61/32) || (dst net 16.0.124.62/31) || (dst net 16.0.124.64/26) || (dst net 16.0.124.128/25) || (dst net 16.0.125.0/24) || (dst net 16.0.126.0/23) || (dst net 16.0.128.0/20) || (dst net 16.0.144.0/23) || (dst net 16.0.146.0/25) || (dst net 16.0.146.128/27) || (dst net 16.0.146.160/28) || (dst net 16.0.146.176/29) || (dst net 16.0.146.184/30) || (dst net 16.0.146.188/32) || (dst net 16.0.146.190/31) || (dst net 16.0.146.192/26) || (dst net 16.0.147.0/24) || (dst net 16.0.148.0/22) || (dst net 16.0.152.0/21) || (dst net 16.0.160.0/19) || (dst net 16.0.192.0/18) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((ip proto 17)) && ((dst port 1234)) && ((dst net 200.0.0.2/32)),
);

// Performance Testers
setIPClas :: SetCycleCount;
getIPClas0 :: CycleCountAccum;
getIPClas1 :: CycleCountAccum;
getIPClas2 :: CycleCountAccum;
getIPClas3 :: CycleCountAccum;
getIPClas4 :: CycleCountAccum;
getIPClas5 :: CycleCountAccum;
getIPClas6 :: CycleCountAccum;
getIPClas7 :: CycleCountAccum;
getIPClas8 :: CycleCountAccum;
getIPClas9 :: CycleCountAccum;
getIPClas10 :: CycleCountAccum;
getIPClas11 :: CycleCountAccum;
getIPClas12 :: CycleCountAccum;
getIPClas13 :: CycleCountAccum;
getIPClas14 :: CycleCountAccum;
getIPClas15 :: CycleCountAccum;

strip -> markIPHeader -> setIPClas -> [0]ipclassifier;

ipclassifier[0] -> getIPClas0 -> Discard ();
ipclassifier[1] -> getIPClas1 -> Discard ();
ipclassifier[2] -> getIPClas2 -> Discard ();
ipclassifier[3] -> getIPClas3 -> Discard ();
ipclassifier[4] -> getIPClas4 -> Discard ();
ipclassifier[5] -> getIPClas5 -> Discard ();
ipclassifier[6] -> getIPClas6 -> Discard ();
ipclassifier[7] -> getIPClas7 -> Discard ();
ipclassifier[8] -> getIPClas8 -> Discard ();
ipclassifier[9] -> getIPClas9 -> Discard ();
ipclassifier[10] -> getIPClas10 -> Discard ();
ipclassifier[11] -> getIPClas11 -> Discard ();
ipclassifier[12] -> getIPClas12 -> Discard ();
ipclassifier[13] -> getIPClas13 -> Discard ();
ipclassifier[14] -> getIPClas14 -> Discard ();
ipclassifier[15] -> getIPClas15 -> Discard ();
/////////////////////////////////////////////////////////////////////////////
// Configuration
define(
	$iface0      em4,
	$macAddr0    ec:f4:bb:d5:fe:d5,
	$ipAddr0     100.0.0.1,
	$ipNetHost0  100.0.0.0/32,
	$ipBcast0    100.0.0.255/32,
	$ipNet0      100.0.0.0/24,
	$color0      1,

	$iface1      eth0,
	$macAddr1    00:60:6e:d5:8a:b8,
	$ipAddr1     200.0.0.1,
	$ipNetHost1  200.0.0.0/32,
	$ipBcast1    200.0.0.255/32,
	$ipNet1      200.0.0.0/24,
	$color1      2,

	$gwIPAddr    200.0.0.2,
	$gwMACAddr   00:00:00:00:00:04,
	$gwPort      2,

	$queueSize   1000000,
	$mtuSize     9000,
	$burst       8
);
/////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////
// Elements
elementclass IPClassifierBench {
	// Module's arguments
	$iface0, $macAddr0,  $ipAddr0, $ipNetHost0, $ipBcast0, $ipNet0, $color0,
	$iface1, $macAddr1,  $ipAddr1, $ipNetHost1, $ipBcast1, $ipNet1, $color1,
	$gwIPAddr, $gwMACAddr, $gwPort, $queueSize, $mtuSize, $burst, $io_method |

	// Queues
	queue :: Queue($queueSize);

	// Module's I/O
	in  :: FromDevice($iface0, BURST $burst);
	out :: ToDevice  ($iface1, BURST $burst);
	
	// ARP Querier
	etherEncap :: EtherEncap(0x0800, $macAddr1, $gwMACAddr);

	// Strip Ethernet header
	strip :: Strip(14);

	// Check IP header's integrity
	markIPHeader :: MarkIPHeader;

	// Measure the incoming pkt rate
	getRate :: AverageCounter;

	/////////////////////////////////////////////////////////////////////
	// Interface's pipeline
	/////////////////////////////////////////////////////////////////////
	// Input
	in -> getRate -> strip;

	// Output
	Idle -> etherEncap -> queue -> out;

	
ipclassifier :: IPClassifier(
	((dst port 9725) || (dst port 20421) || (dst port 55742) || (dst port 56855) || (dst port 63369)) && ((dst net 16.0.0.0/19) || (dst net 16.0.32.0/20) || (dst net 16.0.48.0/21) || (dst net 16.0.56.0/23) || (dst net 16.0.58.0/24) || (dst net 16.0.59.0/26) || (dst net 16.0.59.64/27) || (dst net 16.0.59.96/29) || (dst net 16.0.59.104/32) || (dst net 16.0.59.106/31) || (dst net 16.0.59.108/30) || (dst net 16.0.59.112/28) || (dst net 16.0.59.128/25) || (dst net 16.0.60.0/22) || (dst net 16.0.64.0/19) || (dst net 16.0.96.0/22) || (dst net 16.0.100.0/23) || (dst net 16.0.102.0/24) || (dst net 16.0.103.0/26) || (dst net 16.0.103.64/28) || (dst net 16.0.103.80/32) || (dst net 16.0.103.82/31) || (dst net 16.0.103.84/30) || (dst net 16.0.103.88/29) || (dst net 16.0.103.96/27) || (dst net 16.0.103.128/25) || (dst net 16.0.104.0/22) || (dst net 16.0.108.0/23) || (dst net 16.0.110.0/27) || (dst net 16.0.110.32/28) || (dst net 16.0.110.48/29) || (dst net 16.0.110.56/30) || (dst net 16.0.110.60/32) || (dst net 16.0.110.62/31) || (dst net 16.0.110.64/26) || (dst net 16.0.110.128/25) || (dst net 16.0.111.0/24) || (dst net 16.0.112.0/20) || (dst net 16.0.128.0/21) || (dst net 16.0.136.0/24) || (dst net 16.0.137.0/26) || (dst net 16.0.137.64/28) || (dst net 16.0.137.80/29) || (dst net 16.0.137.88/31) || (dst net 16.0.137.91/32) || (dst net 16.0.137.92/30) || (dst net 16.0.137.96/27) || (dst net 16.0.137.128/25) || (dst net 16.0.138.0/23) || (dst net 16.0.140.0/22) || (dst net 16.0.144.0/20) || (dst net 16.0.160.0/19) || (dst net 16.0.192.0/19) || (dst net 16.0.224.0/20) || (dst net 16.0.240.0/21) || (dst net 16.0.248.0/22) || (dst net 16.0.252.0/25) || (dst net 16.0.252.128/26) || (dst net 16.0.252.192/31) || (dst net 16.0.252.194/32) || (dst net 16.0.252.196/30) || (dst net 16.0.252.200/29) || (dst net 16.0.252.208/28) || (dst net 16.0.252.224/27) || (dst net 16.0.253.0/24) || (dst net 16.0.254.0/23) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 10434) || (dst port 35491) || (dst port 37540) || (dst port 53440) || (dst port 61949)) && ((dst net 16.0.0.0/18) || (dst net 16.0.64.0/19) || (dst net 16.0.96.0/20) || (dst net 16.0.112.0/22) || (dst net 16.0.116.0/23) || (dst net 16.0.118.0/24) || (dst net 16.0.119.0/25) || (dst net 16.0.119.128/26) || (dst net 16.0.119.192/28) || (dst net 16.0.119.208/30) || (dst net 16.0.119.213/32) || (dst net 16.0.119.214/31) || (dst net 16.0.119.216/29) || (dst net 16.0.119.224/27) || (dst net 16.0.120.0/21) || (dst net 16.0.128.0/19) || (dst net 16.0.160.0/23) || (dst net 16.0.162.0/24) || (dst net 16.0.163.0/25) || (dst net 16.0.163.128/27) || (dst net 16.0.163.160/28) || (dst net 16.0.163.176/29) || (dst net 16.0.163.184/32) || (dst net 16.0.163.186/31) || (dst net 16.0.163.188/30) || (dst net 16.0.163.192/26) || (dst net 16.0.164.0/22) || (dst net 16.0.168.0/21) || (dst net 16.0.176.0/25) || (dst net 16.0.176.128/26) || (dst net 16.0.176.192/28) || (dst net 16.0.176.208/30) || (dst net 16.0.176.212/31) || (dst net 16.0.176.214/32) || (dst net 16.0.176.216/29) || (dst net 16.0.176.224/27) || (dst net 16.0.177.0/24) || (dst net 16.0.178.0/23) || (dst net 16.0.180.0/22) || (dst net 16.0.184.0/21) || (dst net 16.0.192.0/19) || (dst net 16.0.224.0/21) || (dst net 16.0.232.0/22) || (dst net 16.0.236.0/23) || (dst net 16.0.238.0/25) || (dst net 16.0.238.128/28) || (dst net 16.0.238.144/31) || (dst net 16.0.238.146/32) || (dst net 16.0.238.148/30) || (dst net 16.0.238.152/29) || (dst net 16.0.238.160/27) || (dst net 16.0.238.192/26) || (dst net 16.0.239.0/24) || (dst net 16.0.240.0/21) || (dst net 16.0.248.0/22) || (dst net 16.0.252.0/23) || (dst net 16.0.254.0/24) || (dst net 16.0.255.0/26) || (dst net 16.0.255.64/27) || (dst net 16.0.255.96/30) || (dst net 16.0.255.101/32) || (dst net 16.0.255.102/31) || (dst net 16.0.255.104/29) || (dst net 16.0.255.112/28) || (dst net 16.0.255.128/25) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 1468) || (dst port 6326) || (dst port 33999) || (dst port 36798) || (dst port 56157)) && ((dst net 16.0.0.0/21) || (dst net 16.0.8.0/23) || (dst net 16.0.10.0/25) || (dst net 16.0.10.128/31) || (dst net 16.0.10.130/32) || (dst net 16.0.10.132/30) || (dst net 16.0.10.136/29) || (dst net 16.0.10.144/28) || (dst net 16.0.10.160/27) || (dst net 16.0.10.192/26) || (dst net 16.0.11.0/24) || (dst net 16.0.12.0/22) || (dst net 16.0.16.0/21) || (dst net 16.0.24.0/22) || (dst net 16.0.28.0/27) || (dst net 16.0.28.32/29) || (dst net 16.0.28.40/31) || (dst net 16.0.28.43/32) || (dst net 16.0.28.44/30) || (dst net 16.0.28.48/28) || (dst net 16.0.28.64/26) || (dst net 16.0.28.128/25) || (dst net 16.0.29.0/24) || (dst net 16.0.30.0/23) || (dst net 16.0.32.0/22) || (dst net 16.0.36.0/23) || (dst net 16.0.38.0/24) || (dst net 16.0.39.0/25) || (dst net 16.0.39.128/26) || (dst net 16.0.39.192/29) || (dst net 16.0.39.200/32) || (dst net 16.0.39.202/31) || (dst net 16.0.39.204/30) || (dst net 16.0.39.208/28) || (dst net 16.0.39.224/27) || (dst net 16.0.40.0/21) || (dst net 16.0.48.0/20) || (dst net 16.0.64.0/20) || (dst net 16.0.80.0/22) || (dst net 16.0.84.0/23) || (dst net 16.0.86.0/24) || (dst net 16.0.87.0/25) || (dst net 16.0.87.128/26) || (dst net 16.0.87.192/27) || (dst net 16.0.87.224/28) || (dst net 16.0.87.240/30) || (dst net 16.0.87.244/31) || (dst net 16.0.87.246/32) || (dst net 16.0.87.248/29) || (dst net 16.0.88.0/21) || (dst net 16.0.96.0/19) || (dst net 16.0.128.0/18) || (dst net 16.0.192.0/20) || (dst net 16.0.208.0/23) || (dst net 16.0.210.0/26) || (dst net 16.0.210.64/30) || (dst net 16.0.210.69/32) || (dst net 16.0.210.70/31) || (dst net 16.0.210.72/29) || (dst net 16.0.210.80/28) || (dst net 16.0.210.96/27) || (dst net 16.0.210.128/25) || (dst net 16.0.211.0/24) || (dst net 16.0.212.0/22) || (dst net 16.0.216.0/21) || (dst net 16.0.224.0/19) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 4344) || (dst port 9221) || (dst port 12582) || (dst port 22667) || (dst port 43975)) && ((dst net 16.0.0.0/22) || (dst net 16.0.4.0/24) || (dst net 16.0.5.0/25) || (dst net 16.0.5.128/26) || (dst net 16.0.5.192/28) || (dst net 16.0.5.208/30) || (dst net 16.0.5.212/31) || (dst net 16.0.5.215/32) || (dst net 16.0.5.216/29) || (dst net 16.0.5.224/27) || (dst net 16.0.6.0/23) || (dst net 16.0.8.0/21) || (dst net 16.0.16.0/20) || (dst net 16.0.32.0/19) || (dst net 16.0.64.0/18) || (dst net 16.0.128.0/22) || (dst net 16.0.132.0/26) || (dst net 16.0.132.64/28) || (dst net 16.0.132.80/30) || (dst net 16.0.132.84/32) || (dst net 16.0.132.86/31) || (dst net 16.0.132.88/29) || (dst net 16.0.132.96/27) || (dst net 16.0.132.128/25) || (dst net 16.0.133.0/24) || (dst net 16.0.134.0/23) || (dst net 16.0.136.0/21) || (dst net 16.0.144.0/20) || (dst net 16.0.160.0/21) || (dst net 16.0.168.0/22) || (dst net 16.0.172.0/25) || (dst net 16.0.172.128/27) || (dst net 16.0.172.160/29) || (dst net 16.0.172.168/30) || (dst net 16.0.172.172/31) || (dst net 16.0.172.174/32) || (dst net 16.0.172.176/28) || (dst net 16.0.172.192/26) || (dst net 16.0.173.0/24) || (dst net 16.0.174.0/23) || (dst net 16.0.176.0/23) || (dst net 16.0.178.0/25) || (dst net 16.0.178.128/26) || (dst net 16.0.178.192/29) || (dst net 16.0.178.200/30) || (dst net 16.0.178.204/31) || (dst net 16.0.178.206/32) || (dst net 16.0.178.208/28) || (dst net 16.0.178.224/27) || (dst net 16.0.179.0/24) || (dst net 16.0.180.0/22) || (dst net 16.0.184.0/22) || (dst net 16.0.188.0/25) || (dst net 16.0.188.128/27) || (dst net 16.0.188.160/28) || (dst net 16.0.188.176/29) || (dst net 16.0.188.185/32) || (dst net 16.0.188.186/31) || (dst net 16.0.188.188/30) || (dst net 16.0.188.192/26) || (dst net 16.0.189.0/24) || (dst net 16.0.190.0/23) || (dst net 16.0.192.0/18) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 1726) || (dst port 5067) || (dst port 45295) || (dst port 46774) || (dst port 49962)) && ((dst net 16.0.0.0/19) || (dst net 16.0.32.0/21) || (dst net 16.0.40.0/23) || (dst net 16.0.42.0/25) || (dst net 16.0.42.128/26) || (dst net 16.0.42.192/28) || (dst net 16.0.42.208/30) || (dst net 16.0.42.212/32) || (dst net 16.0.42.214/31) || (dst net 16.0.42.216/29) || (dst net 16.0.42.224/27) || (dst net 16.0.43.0/24) || (dst net 16.0.44.0/22) || (dst net 16.0.48.0/21) || (dst net 16.0.56.0/25) || (dst net 16.0.56.128/27) || (dst net 16.0.56.160/28) || (dst net 16.0.56.176/29) || (dst net 16.0.56.184/30) || (dst net 16.0.56.188/31) || (dst net 16.0.56.191/32) || (dst net 16.0.56.192/26) || (dst net 16.0.57.0/24) || (dst net 16.0.58.0/23) || (dst net 16.0.60.0/22) || (dst net 16.0.64.0/19) || (dst net 16.0.96.0/24) || (dst net 16.0.97.0/26) || (dst net 16.0.97.64/29) || (dst net 16.0.97.72/30) || (dst net 16.0.97.76/31) || (dst net 16.0.97.78/32) || (dst net 16.0.97.80/28) || (dst net 16.0.97.96/27) || (dst net 16.0.97.128/25) || (dst net 16.0.98.0/23) || (dst net 16.0.100.0/22) || (dst net 16.0.104.0/21) || (dst net 16.0.112.0/20) || (dst net 16.0.128.0/20) || (dst net 16.0.144.0/22) || (dst net 16.0.148.0/23) || (dst net 16.0.150.0/30) || (dst net 16.0.150.4/31) || (dst net 16.0.150.7/32) || (dst net 16.0.150.8/29) || (dst net 16.0.150.16/28) || (dst net 16.0.150.32/27) || (dst net 16.0.150.64/26) || (dst net 16.0.150.128/25) || (dst net 16.0.151.0/24) || (dst net 16.0.152.0/21) || (dst net 16.0.160.0/19) || (dst net 16.0.192.0/19) || (dst net 16.0.224.0/21) || (dst net 16.0.232.0/23) || (dst net 16.0.234.0/24) || (dst net 16.0.235.0/25) || (dst net 16.0.235.128/26) || (dst net 16.0.235.192/28) || (dst net 16.0.235.209/32) || (dst net 16.0.235.210/31) || (dst net 16.0.235.212/30) || (dst net 16.0.235.216/29) || (dst net 16.0.235.224/27) || (dst net 16.0.236.0/22) || (dst net 16.0.240.0/20) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 34036) || (dst port 39430) || (dst port 47438) || (dst port 54478) || (dst port 60244)) && ((dst net 16.0.0.0/18) || (dst net 16.0.64.0/19) || (dst net 16.0.96.0/21) || (dst net 16.0.104.0/22) || (dst net 16.0.108.0/23) || (dst net 16.0.110.0/27) || (dst net 16.0.110.32/28) || (dst net 16.0.110.48/31) || (dst net 16.0.110.51/32) || (dst net 16.0.110.52/30) || (dst net 16.0.110.56/29) || (dst net 16.0.110.64/26) || (dst net 16.0.110.128/25) || (dst net 16.0.111.0/24) || (dst net 16.0.112.0/20) || (dst net 16.0.128.0/24) || (dst net 16.0.129.0/25) || (dst net 16.0.129.128/29) || (dst net 16.0.129.137/32) || (dst net 16.0.129.138/31) || (dst net 16.0.129.140/30) || (dst net 16.0.129.144/28) || (dst net 16.0.129.160/27) || (dst net 16.0.129.192/26) || (dst net 16.0.130.0/23) || (dst net 16.0.132.0/22) || (dst net 16.0.136.0/21) || (dst net 16.0.144.0/22) || (dst net 16.0.148.0/23) || (dst net 16.0.150.0/25) || (dst net 16.0.150.128/26) || (dst net 16.0.150.192/27) || (dst net 16.0.150.224/28) || (dst net 16.0.150.240/29) || (dst net 16.0.150.248/30) || (dst net 16.0.150.252/31) || (dst net 16.0.150.255/32) || (dst net 16.0.151.0/24) || (dst net 16.0.152.0/21) || (dst net 16.0.160.0/19) || (dst net 16.0.192.0/19) || (dst net 16.0.224.0/21) || (dst net 16.0.232.0/22) || (dst net 16.0.236.0/25) || (dst net 16.0.236.128/26) || (dst net 16.0.236.192/27) || (dst net 16.0.236.224/29) || (dst net 16.0.236.232/30) || (dst net 16.0.236.236/31) || (dst net 16.0.236.238/32) || (dst net 16.0.236.240/28) || (dst net 16.0.237.0/24) || (dst net 16.0.238.0/31) || (dst net 16.0.238.3/32) || (dst net 16.0.238.4/30) || (dst net 16.0.238.8/29) || (dst net 16.0.238.16/28) || (dst net 16.0.238.32/27) || (dst net 16.0.238.64/26) || (dst net 16.0.238.128/25) || (dst net 16.0.239.0/24) || (dst net 16.0.240.0/20) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 6385) || (dst port 34828) || (dst port 35963) || (dst port 43717) || (dst port 45782)) && ((dst net 16.0.0.0/19) || (dst net 16.0.32.0/21) || (dst net 16.0.40.0/24) || (dst net 16.0.41.0/26) || (dst net 16.0.41.64/28) || (dst net 16.0.41.80/31) || (dst net 16.0.41.82/32) || (dst net 16.0.41.84/30) || (dst net 16.0.41.88/29) || (dst net 16.0.41.96/27) || (dst net 16.0.41.128/25) || (dst net 16.0.42.0/23) || (dst net 16.0.44.0/22) || (dst net 16.0.48.0/20) || (dst net 16.0.64.0/22) || (dst net 16.0.68.0/24) || (dst net 16.0.69.0/25) || (dst net 16.0.69.128/26) || (dst net 16.0.69.192/27) || (dst net 16.0.69.224/28) || (dst net 16.0.69.240/30) || (dst net 16.0.69.245/32) || (dst net 16.0.69.246/31) || (dst net 16.0.69.248/29) || (dst net 16.0.70.0/23) || (dst net 16.0.72.0/21) || (dst net 16.0.80.0/20) || (dst net 16.0.96.0/20) || (dst net 16.0.112.0/21) || (dst net 16.0.120.0/22) || (dst net 16.0.124.0/24) || (dst net 16.0.125.0/25) || (dst net 16.0.125.128/27) || (dst net 16.0.125.160/30) || (dst net 16.0.125.164/31) || (dst net 16.0.125.166/32) || (dst net 16.0.125.168/29) || (dst net 16.0.125.176/28) || (dst net 16.0.125.192/26) || (dst net 16.0.126.0/23) || (dst net 16.0.128.0/20) || (dst net 16.0.144.0/23) || (dst net 16.0.146.0/24) || (dst net 16.0.147.0/29) || (dst net 16.0.147.8/31) || (dst net 16.0.147.11/32) || (dst net 16.0.147.12/30) || (dst net 16.0.147.16/28) || (dst net 16.0.147.32/27) || (dst net 16.0.147.64/26) || (dst net 16.0.147.128/25) || (dst net 16.0.148.0/22) || (dst net 16.0.152.0/21) || (dst net 16.0.160.0/19) || (dst net 16.0.192.0/19) || (dst net 16.0.224.0/20) || (dst net 16.0.240.0/21) || (dst net 16.0.248.0/24) || (dst net 16.0.249.0/25) || (dst net 16.0.249.128/26) || (dst net 16.0.249.192/27) || (dst net 16.0.249.224/30) || (dst net 16.0.249.229/32) || (dst net 16.0.249.230/31) || (dst net 16.0.249.232/29) || (dst net 16.0.249.240/28) || (dst net 16.0.250.0/23) || (dst net 16.0.252.0/22) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 2074) || (dst port 9910) || (dst port 28922) || (dst port 32918) || (dst port 47932)) && ((dst net 16.0.0.0/18) || (dst net 16.0.64.0/19) || (dst net 16.0.96.0/20) || (dst net 16.0.112.0/21) || (dst net 16.0.120.0/22) || (dst net 16.0.124.0/23) || (dst net 16.0.126.0/25) || (dst net 16.0.126.128/26) || (dst net 16.0.126.192/32) || (dst net 16.0.126.194/31) || (dst net 16.0.126.196/30) || (dst net 16.0.126.200/29) || (dst net 16.0.126.208/28) || (dst net 16.0.126.224/27) || (dst net 16.0.127.0/24) || (dst net 16.0.128.0/20) || (dst net 16.0.144.0/23) || (dst net 16.0.146.0/26) || (dst net 16.0.146.64/28) || (dst net 16.0.146.80/30) || (dst net 16.0.146.85/32) || (dst net 16.0.146.86/31) || (dst net 16.0.146.88/29) || (dst net 16.0.146.96/27) || (dst net 16.0.146.128/25) || (dst net 16.0.147.0/24) || (dst net 16.0.148.0/23) || (dst net 16.0.150.0/25) || (dst net 16.0.150.128/26) || (dst net 16.0.150.192/31) || (dst net 16.0.150.195/32) || (dst net 16.0.150.196/30) || (dst net 16.0.150.200/29) || (dst net 16.0.150.208/28) || (dst net 16.0.150.224/27) || (dst net 16.0.151.0/24) || (dst net 16.0.152.0/22) || (dst net 16.0.156.0/26) || (dst net 16.0.156.64/28) || (dst net 16.0.156.80/29) || (dst net 16.0.156.88/31) || (dst net 16.0.156.91/32) || (dst net 16.0.156.92/30) || (dst net 16.0.156.96/27) || (dst net 16.0.156.128/25) || (dst net 16.0.157.0/24) || (dst net 16.0.158.0/23) || (dst net 16.0.160.0/21) || (dst net 16.0.168.0/23) || (dst net 16.0.170.0/24) || (dst net 16.0.171.0/32) || (dst net 16.0.171.2/31) || (dst net 16.0.171.4/30) || (dst net 16.0.171.8/29) || (dst net 16.0.171.16/28) || (dst net 16.0.171.32/27) || (dst net 16.0.171.64/26) || (dst net 16.0.171.128/25) || (dst net 16.0.172.0/22) || (dst net 16.0.176.0/20) || (dst net 16.0.192.0/18) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 7024) || (dst port 25098) || (dst port 36165) || (dst port 39137) || (dst port 40050)) && ((dst net 16.0.0.0/21) || (dst net 16.0.8.0/25) || (dst net 16.0.8.128/26) || (dst net 16.0.8.192/27) || (dst net 16.0.8.224/28) || (dst net 16.0.8.240/29) || (dst net 16.0.8.248/32) || (dst net 16.0.8.250/31) || (dst net 16.0.8.252/30) || (dst net 16.0.9.0/24) || (dst net 16.0.10.0/23) || (dst net 16.0.12.0/24) || (dst net 16.0.13.0/27) || (dst net 16.0.13.32/28) || (dst net 16.0.13.48/30) || (dst net 16.0.13.52/31) || (dst net 16.0.13.55/32) || (dst net 16.0.13.56/29) || (dst net 16.0.13.64/26) || (dst net 16.0.13.128/25) || (dst net 16.0.14.0/23) || (dst net 16.0.16.0/20) || (dst net 16.0.32.0/20) || (dst net 16.0.48.0/21) || (dst net 16.0.56.0/22) || (dst net 16.0.60.0/23) || (dst net 16.0.62.0/25) || (dst net 16.0.62.128/26) || (dst net 16.0.62.192/31) || (dst net 16.0.62.195/32) || (dst net 16.0.62.196/30) || (dst net 16.0.62.200/29) || (dst net 16.0.62.208/28) || (dst net 16.0.62.224/27) || (dst net 16.0.63.0/24) || (dst net 16.0.64.0/20) || (dst net 16.0.80.0/23) || (dst net 16.0.82.0/28) || (dst net 16.0.82.16/30) || (dst net 16.0.82.20/31) || (dst net 16.0.82.23/32) || (dst net 16.0.82.24/29) || (dst net 16.0.82.32/27) || (dst net 16.0.82.64/26) || (dst net 16.0.82.128/25) || (dst net 16.0.83.0/24) || (dst net 16.0.84.0/22) || (dst net 16.0.88.0/21) || (dst net 16.0.96.0/19) || (dst net 16.0.128.0/22) || (dst net 16.0.132.0/24) || (dst net 16.0.133.0/25) || (dst net 16.0.133.128/27) || (dst net 16.0.133.160/30) || (dst net 16.0.133.164/31) || (dst net 16.0.133.167/32) || (dst net 16.0.133.168/29) || (dst net 16.0.133.176/28) || (dst net 16.0.133.192/26) || (dst net 16.0.134.0/23) || (dst net 16.0.136.0/21) || (dst net 16.0.144.0/20) || (dst net 16.0.160.0/19) || (dst net 16.0.192.0/18) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 26709) || (dst port 31444) || (dst port 31907) || (dst port 45679) || (dst port 46561)) && ((dst net 16.0.0.0/18) || (dst net 16.0.64.0/19) || (dst net 16.0.96.0/20) || (dst net 16.0.112.0/21) || (dst net 16.0.120.0/22) || (dst net 16.0.124.0/25) || (dst net 16.0.124.128/28) || (dst net 16.0.124.144/29) || (dst net 16.0.124.153/32) || (dst net 16.0.124.154/31) || (dst net 16.0.124.156/30) || (dst net 16.0.124.160/27) || (dst net 16.0.124.192/26) || (dst net 16.0.125.0/24) || (dst net 16.0.126.0/23) || (dst net 16.0.128.0/23) || (dst net 16.0.130.0/24) || (dst net 16.0.131.0/26) || (dst net 16.0.131.64/28) || (dst net 16.0.131.80/29) || (dst net 16.0.131.88/30) || (dst net 16.0.131.92/31) || (dst net 16.0.131.95/32) || (dst net 16.0.131.96/27) || (dst net 16.0.131.128/25) || (dst net 16.0.132.0/22) || (dst net 16.0.136.0/21) || (dst net 16.0.144.0/20) || (dst net 16.0.160.0/22) || (dst net 16.0.164.0/23) || (dst net 16.0.166.0/26) || (dst net 16.0.166.64/27) || (dst net 16.0.166.96/28) || (dst net 16.0.166.113/32) || (dst net 16.0.166.114/31) || (dst net 16.0.166.116/30) || (dst net 16.0.166.120/29) || (dst net 16.0.166.128/25) || (dst net 16.0.167.0/24) || (dst net 16.0.168.0/21) || (dst net 16.0.176.0/20) || (dst net 16.0.192.0/22) || (dst net 16.0.196.0/24) || (dst net 16.0.197.0/25) || (dst net 16.0.197.128/27) || (dst net 16.0.197.160/30) || (dst net 16.0.197.164/32) || (dst net 16.0.197.166/31) || (dst net 16.0.197.168/29) || (dst net 16.0.197.176/28) || (dst net 16.0.197.192/26) || (dst net 16.0.198.0/23) || (dst net 16.0.200.0/21) || (dst net 16.0.208.0/20) || (dst net 16.0.224.0/21) || (dst net 16.0.232.0/22) || (dst net 16.0.236.0/23) || (dst net 16.0.238.0/24) || (dst net 16.0.239.0/26) || (dst net 16.0.239.64/27) || (dst net 16.0.239.96/29) || (dst net 16.0.239.104/30) || (dst net 16.0.239.108/31) || (dst net 16.0.239.111/32) || (dst net 16.0.239.112/28) || (dst net 16.0.239.128/25) || (dst net 16.0.240.0/20) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 15427) || (dst port 27099) || (dst port 34767) || (dst port 39157) || (dst port 61491)) && ((dst net 16.0.0.0/18) || (dst net 16.0.64.0/22) || (dst net 16.0.68.0/23) || (dst net 16.0.70.0/25) || (dst net 16.0.70.128/26) || (dst net 16.0.70.192/28) || (dst net 16.0.70.208/31) || (dst net 16.0.70.211/32) || (dst net 16.0.70.212/30) || (dst net 16.0.70.216/29) || (dst net 16.0.70.224/27) || (dst net 16.0.71.0/25) || (dst net 16.0.71.128/27) || (dst net 16.0.71.160/28) || (dst net 16.0.71.176/30) || (dst net 16.0.71.180/32) || (dst net 16.0.71.182/31) || (dst net 16.0.71.184/29) || (dst net 16.0.71.192/26) || (dst net 16.0.72.0/21) || (dst net 16.0.80.0/20) || (dst net 16.0.96.0/19) || (dst net 16.0.128.0/21) || (dst net 16.0.136.0/25) || (dst net 16.0.136.128/26) || (dst net 16.0.136.192/31) || (dst net 16.0.136.195/32) || (dst net 16.0.136.196/30) || (dst net 16.0.136.200/29) || (dst net 16.0.136.208/28) || (dst net 16.0.136.224/27) || (dst net 16.0.137.0/24) || (dst net 16.0.138.0/23) || (dst net 16.0.140.0/22) || (dst net 16.0.144.0/21) || (dst net 16.0.152.0/23) || (dst net 16.0.154.0/24) || (dst net 16.0.155.0/30) || (dst net 16.0.155.4/32) || (dst net 16.0.155.6/31) || (dst net 16.0.155.8/29) || (dst net 16.0.155.16/28) || (dst net 16.0.155.32/27) || (dst net 16.0.155.64/26) || (dst net 16.0.155.128/25) || (dst net 16.0.156.0/22) || (dst net 16.0.160.0/20) || (dst net 16.0.176.0/22) || (dst net 16.0.180.0/28) || (dst net 16.0.180.16/32) || (dst net 16.0.180.18/31) || (dst net 16.0.180.20/30) || (dst net 16.0.180.24/29) || (dst net 16.0.180.32/27) || (dst net 16.0.180.64/26) || (dst net 16.0.180.128/25) || (dst net 16.0.181.0/24) || (dst net 16.0.182.0/23) || (dst net 16.0.184.0/21) || (dst net 16.0.192.0/18) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 9416) || (dst port 15091) || (dst port 16477) || (dst port 42698) || (dst port 58952)) && ((dst net 16.0.0.0/17) || (dst net 16.0.128.0/22) || (dst net 16.0.132.0/23) || (dst net 16.0.134.0/24) || (dst net 16.0.135.0/30) || (dst net 16.0.135.4/32) || (dst net 16.0.135.6/31) || (dst net 16.0.135.8/29) || (dst net 16.0.135.16/28) || (dst net 16.0.135.32/27) || (dst net 16.0.135.64/26) || (dst net 16.0.135.128/25) || (dst net 16.0.136.0/21) || (dst net 16.0.144.0/20) || (dst net 16.0.160.0/21) || (dst net 16.0.168.0/22) || (dst net 16.0.172.0/23) || (dst net 16.0.174.0/26) || (dst net 16.0.174.64/27) || (dst net 16.0.174.96/28) || (dst net 16.0.174.112/30) || (dst net 16.0.174.116/31) || (dst net 16.0.174.118/32) || (dst net 16.0.174.120/29) || (dst net 16.0.174.128/25) || (dst net 16.0.175.0/24) || (dst net 16.0.176.0/20) || (dst net 16.0.192.0/21) || (dst net 16.0.200.0/26) || (dst net 16.0.200.64/27) || (dst net 16.0.200.96/28) || (dst net 16.0.200.112/30) || (dst net 16.0.200.117/32) || (dst net 16.0.200.118/31) || (dst net 16.0.200.120/29) || (dst net 16.0.200.128/25) || (dst net 16.0.201.0/24) || (dst net 16.0.202.0/23) || (dst net 16.0.204.0/22) || (dst net 16.0.208.0/23) || (dst net 16.0.210.0/27) || (dst net 16.0.210.32/28) || (dst net 16.0.210.48/29) || (dst net 16.0.210.56/31) || (dst net 16.0.210.59/32) || (dst net 16.0.210.60/30) || (dst net 16.0.210.64/26) || (dst net 16.0.210.128/25) || (dst net 16.0.211.0/24) || (dst net 16.0.212.0/22) || (dst net 16.0.216.0/21) || (dst net 16.0.224.0/21) || (dst net 16.0.232.0/23) || (dst net 16.0.234.0/24) || (dst net 16.0.235.0/25) || (dst net 16.0.235.128/28) || (dst net 16.0.235.144/30) || (dst net 16.0.235.148/31) || (dst net 16.0.235.150/32) || (dst net 16.0.235.152/29) || (dst net 16.0.235.160/27) || (dst net 16.0.235.192/26) || (dst net 16.0.236.0/22) || (dst net 16.0.240.0/20) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 8057) || (dst port 27294) || (dst port 33215) || (dst port 46038) || (dst port 62420)) && ((dst net 16.0.0.0/24) || (dst net 16.0.1.0/27) || (dst net 16.0.1.32/28) || (dst net 16.0.1.48/29) || (dst net 16.0.1.56/31) || (dst net 16.0.1.58/32) || (dst net 16.0.1.60/30) || (dst net 16.0.1.64/26) || (dst net 16.0.1.128/25) || (dst net 16.0.2.0/23) || (dst net 16.0.4.0/22) || (dst net 16.0.8.0/21) || (dst net 16.0.16.0/20) || (dst net 16.0.32.0/19) || (dst net 16.0.64.0/22) || (dst net 16.0.68.0/23) || (dst net 16.0.70.0/26) || (dst net 16.0.70.64/27) || (dst net 16.0.70.96/28) || (dst net 16.0.70.112/29) || (dst net 16.0.70.120/30) || (dst net 16.0.70.124/31) || (dst net 16.0.70.127/32) || (dst net 16.0.70.128/25) || (dst net 16.0.71.0/26) || (dst net 16.0.71.64/27) || (dst net 16.0.71.96/29) || (dst net 16.0.71.105/32) || (dst net 16.0.71.106/31) || (dst net 16.0.71.108/30) || (dst net 16.0.71.112/28) || (dst net 16.0.71.128/25) || (dst net 16.0.72.0/21) || (dst net 16.0.80.0/20) || (dst net 16.0.96.0/19) || (dst net 16.0.128.0/18) || (dst net 16.0.192.0/20) || (dst net 16.0.208.0/21) || (dst net 16.0.216.0/23) || (dst net 16.0.218.0/24) || (dst net 16.0.219.0/25) || (dst net 16.0.219.128/26) || (dst net 16.0.219.192/28) || (dst net 16.0.219.208/29) || (dst net 16.0.219.216/32) || (dst net 16.0.219.218/31) || (dst net 16.0.219.220/30) || (dst net 16.0.219.224/27) || (dst net 16.0.220.0/22) || (dst net 16.0.224.0/21) || (dst net 16.0.232.0/22) || (dst net 16.0.236.0/23) || (dst net 16.0.238.0/24) || (dst net 16.0.239.0/25) || (dst net 16.0.239.128/28) || (dst net 16.0.239.144/29) || (dst net 16.0.239.152/31) || (dst net 16.0.239.154/32) || (dst net 16.0.239.156/30) || (dst net 16.0.239.160/27) || (dst net 16.0.239.192/26) || (dst net 16.0.240.0/20) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 19468) || (dst port 21677) || (dst port 22185) || (dst port 22582) || (dst port 49652)) && ((dst net 16.0.0.0/20) || (dst net 16.0.16.0/21) || (dst net 16.0.24.0/24) || (dst net 16.0.25.0/25) || (dst net 16.0.25.128/28) || (dst net 16.0.25.145/32) || (dst net 16.0.25.146/31) || (dst net 16.0.25.148/30) || (dst net 16.0.25.152/29) || (dst net 16.0.25.160/27) || (dst net 16.0.25.192/26) || (dst net 16.0.26.0/24) || (dst net 16.0.27.0/25) || (dst net 16.0.27.128/28) || (dst net 16.0.27.144/30) || (dst net 16.0.27.149/32) || (dst net 16.0.27.150/31) || (dst net 16.0.27.152/29) || (dst net 16.0.27.160/27) || (dst net 16.0.27.192/26) || (dst net 16.0.28.0/22) || (dst net 16.0.32.0/19) || (dst net 16.0.64.0/19) || (dst net 16.0.96.0/21) || (dst net 16.0.104.0/22) || (dst net 16.0.108.0/23) || (dst net 16.0.110.0/24) || (dst net 16.0.111.0/25) || (dst net 16.0.111.128/27) || (dst net 16.0.111.160/28) || (dst net 16.0.111.176/29) || (dst net 16.0.111.184/30) || (dst net 16.0.111.188/31) || (dst net 16.0.111.191/32) || (dst net 16.0.111.192/26) || (dst net 16.0.112.0/25) || (dst net 16.0.112.128/26) || (dst net 16.0.112.192/27) || (dst net 16.0.112.224/28) || (dst net 16.0.112.240/30) || (dst net 16.0.112.244/31) || (dst net 16.0.112.246/32) || (dst net 16.0.112.248/29) || (dst net 16.0.113.0/24) || (dst net 16.0.114.0/23) || (dst net 16.0.116.0/22) || (dst net 16.0.120.0/21) || (dst net 16.0.128.0/18) || (dst net 16.0.192.0/22) || (dst net 16.0.196.0/27) || (dst net 16.0.196.32/30) || (dst net 16.0.196.36/32) || (dst net 16.0.196.38/31) || (dst net 16.0.196.40/29) || (dst net 16.0.196.48/28) || (dst net 16.0.196.64/26) || (dst net 16.0.196.128/25) || (dst net 16.0.197.0/24) || (dst net 16.0.198.0/23) || (dst net 16.0.200.0/21) || (dst net 16.0.208.0/20) || (dst net 16.0.224.0/19) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((dst port 24078) || (dst port 32234) || (dst port 52752) || (dst port 56664) || (dst port 63856)) && ((dst net 16.0.0.0/21) || (dst net 16.0.8.0/22) || (dst net 16.0.12.0/23) || (dst net 16.0.14.0/27) || (dst net 16.0.14.32/28) || (dst net 16.0.14.48/29) || (dst net 16.0.14.56/30) || (dst net 16.0.14.61/32) || (dst net 16.0.14.62/31) || (dst net 16.0.14.64/26) || (dst net 16.0.14.128/25) || (dst net 16.0.15.0/24) || (dst net 16.0.16.0/21) || (dst net 16.0.24.0/22) || (dst net 16.0.28.0/24) || (dst net 16.0.29.0/26) || (dst net 16.0.29.64/29) || (dst net 16.0.29.72/30) || (dst net 16.0.29.76/31) || (dst net 16.0.29.79/32) || (dst net 16.0.29.80/28) || (dst net 16.0.29.96/27) || (dst net 16.0.29.128/25) || (dst net 16.0.30.0/23) || (dst net 16.0.32.0/20) || (dst net 16.0.48.0/23) || (dst net 16.0.50.0/24) || (dst net 16.0.51.0/25) || (dst net 16.0.51.128/26) || (dst net 16.0.51.192/28) || (dst net 16.0.51.208/30) || (dst net 16.0.51.212/31) || (dst net 16.0.51.215/32) || (dst net 16.0.51.216/29) || (dst net 16.0.51.224/27) || (dst net 16.0.52.0/22) || (dst net 16.0.56.0/21) || (dst net 16.0.64.0/19) || (dst net 16.0.96.0/20) || (dst net 16.0.112.0/21) || (dst net 16.0.120.0/22) || (dst net 16.0.124.0/27) || (dst net 16.0.124.32/28) || (dst net 16.0.124.48/29) || (dst net 16.0.124.56/30) || (dst net 16.0.124.61/32) || (dst net 16.0.124.62/31) || (dst net 16.0.124.64/26) || (dst net 16.0.124.128/25) || (dst net 16.0.125.0/24) || (dst net 16.0.126.0/23) || (dst net 16.0.128.0/20) || (dst net 16.0.144.0/23) || (dst net 16.0.146.0/25) || (dst net 16.0.146.128/27) || (dst net 16.0.146.160/28) || (dst net 16.0.146.176/29) || (dst net 16.0.146.184/30) || (dst net 16.0.146.188/32) || (dst net 16.0.146.190/31) || (dst net 16.0.146.192/26) || (dst net 16.0.147.0/24) || (dst net 16.0.148.0/22) || (dst net 16.0.152.0/21) || (dst net 16.0.160.0/19) || (dst net 16.0.192.0/18) || (dst net 16.1.0.0/16) || (dst net 16.2.0.0/15) || (dst net 16.4.0.0/14) || (dst net 16.8.0.0/13) || (dst net 16.16.0.0/12) || (dst net 16.32.0.0/11) || (dst net 16.64.0.0/10) || (dst net 16.128.0.0/9)),
	((ip proto 17)) && ((dst port 1234)) && ((dst net 200.0.0.2/32)),
);

// Performance Testers
setIPClas :: SetCycleCount;
getIPClas0 :: CycleCountAccum;
getIPClas1 :: CycleCountAccum;
getIPClas2 :: CycleCountAccum;
getIPClas3 :: CycleCountAccum;
getIPClas4 :: CycleCountAccum;
getIPClas5 :: CycleCountAccum;
getIPClas6 :: CycleCountAccum;
getIPClas7 :: CycleCountAccum;
getIPClas8 :: CycleCountAccum;
getIPClas9 :: CycleCountAccum;
getIPClas10 :: CycleCountAccum;
getIPClas11 :: CycleCountAccum;
getIPClas12 :: CycleCountAccum;
getIPClas13 :: CycleCountAccum;
getIPClas14 :: CycleCountAccum;
getIPClas15 :: CycleCountAccum;

strip -> markIPHeader -> setIPClas -> [0]ipclassifier;

ipclassifier[0] -> getIPClas0 -> Discard ();
ipclassifier[1] -> getIPClas1 -> Discard ();
ipclassifier[2] -> getIPClas2 -> Discard ();
ipclassifier[3] -> getIPClas3 -> Discard ();
ipclassifier[4] -> getIPClas4 -> Discard ();
ipclassifier[5] -> getIPClas5 -> Discard ();
ipclassifier[6] -> getIPClas6 -> Discard ();
ipclassifier[7] -> getIPClas7 -> Discard ();
ipclassifier[8] -> getIPClas8 -> Discard ();
ipclassifier[9] -> getIPClas9 -> Discard ();
ipclassifier[10] -> getIPClas10 -> Discard ();
ipclassifier[11] -> getIPClas11 -> Discard ();
ipclassifier[12] -> getIPClas12 -> Discard ();
ipclassifier[13] -> getIPClas13 -> Discard ();
ipclassifier[14] -> getIPClas14 -> Discard ();
ipclassifier[15] -> getIPClas15 -> Discard ();
	
}
/////////////////////////////////////////////////////////////////////////////


/////////////////////////////////////////////////////////////////////////////
// Scenario
/////////////////////////////////////////////////////////////////////////////
ipclassifier :: IPClassifierBench(
	$iface0, $macAddr0, $ipAddr0, $ipNetHost0, $ipBcast0, $ipNet0, $color0,
	$iface1, $macAddr1, $ipAddr1, $ipNetHost1, $ipBcast1, $ipNet1, $color1,
	$gwIPAddr, $gwMACAddr, $gwPort, $queueSize, $mtuSize, $burst, $io_method
);
/////////////////////////////////////////////////////////////////////////////
